function callAndWrap(workerFunction,parameters,transferList){var resultOrPromise;try{resultOrPromise=workerFunction(parameters,transferList);return resultOrPromise}catch(e){return Promise.reject(e)}}export function createTaskProcessor(workerFunction){var postMessage;return function(event){var data=event.data;var transferList=[];var responseMessage={id:data.id,result:undefined,error:undefined};return Promise.all([callAndWrap(workerFunction,data.parameters,transferList)]).then(function(result){responseMessage.result=result[0]})["catch"](function(e){if(e instanceof Error){responseMessage.error={name:e.name,message:e.message,stack:e.stack}}else{responseMessage.error=e}})["finally"](function(){if(!postMessage){postMessage=self["webkitPostMessage"]||self.postMessage}if(!data.canTransferArrayBuffer){transferList.length=0}try{postMessage(responseMessage,transferList)}catch(e){responseMessage.result=undefined;responseMessage.error="postMessage failed with error: "+e+"\n  with responseMessage: "+JSON.stringify(responseMessage);postMessage(responseMessage)}})}}