import{e as S}from"./error.229cea25.js";import{S as u}from"./serviceManage.8c46f250.js";import{_ as x}from"./SmartMap.vue_vue_type_style_index_0_lang.6bf21d60.js";import{d as w,c as s,r as q,w as g,aj as y,o as j,f as I,g as t,l as M,B as T,j as V}from"./element-plus.59ccb443.js";import"./login.a4e9287e.js";import"../../app-config.js";import"./smart3d.ce055bc9.js";import"./lodash.22f463b4.js";const W={id:"service-viewer"},k={class:"service-viewer-header"},E={class:"logo",href:"#"},J=t("a",{class:"menu",href:"javascript:;"},[t("span",{class:"img"})],-1),L={class:"title"},O={style:{color:"#cdf9ff"}},R={class:"service-viewer-main"},K=w({__name:"index",setup($){const r=S(),n=s(()=>{var e;return((e=r.query)==null?void 0:e.id)||""}),_=s(()=>{var e;return((e=r.query)==null?void 0:e.url)||""}),p=s(()=>{var e;return((e=r.query)==null?void 0:e.layerName)||""}),f=s(()=>{var e;return((e=r.query)==null?void 0:e.rectangle)||""}),v=s(()=>{var e;return((e=r.query)==null?void 0:e.category)||""}),a=q({loading:!1,aliasName:"",url:"",category:"",layerName:"",rectangle:{}});g(()=>n.value,e=>{e&&h()},{immediate:!0}),g([_,v,p,f],e=>{if(e){const[o,i,c,l]=e;a.url=o,a.category=i,a.layerName=c;try{a.rectangle=JSON.parse(l)}catch{}}},{immediate:!0});const N=["WMTS","WMS","WFS"];function h(){a.loading=!0,u.getServiceInfoById(n.value).then(async e=>{if(a.loading=!1,e.code==="0000"){const{name:o,aliasName:i,category:c,url:l,serviceType:m,latLonBoundingBox:d}=e.data;if(m===1&&N.includes(c)){const B=await u.serviceBound(n.value);a.rectangle=B.data}else a.rectangle=d?JSON.parse(d):{};a.layerName=o,a.aliasName=i,a.category=c,a.url=l}else y({type:"error",message:e.message||"获取服务信息失败"})}).catch(()=>{a.loading=!1,y({type:"error",message:"获取服务信息错误"})})}return(e,o)=>(j(),I("div",W,[t("div",k,[t("div",E,[J,t("h2",L,[M(" 服务预览  "),t("span",O,T(a.aliasName),1)])])]),t("div",R,[V(x,{"layer-name":a.layerName,url:a.url,category:a.category,rectangle:a.rectangle,"alias-name":a.aliasName},null,8,["layer-name","url","category","rectangle","alias-name"])])]))}});export{K as default};
