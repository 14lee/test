import{e as C,E as P,_ as V}from"./error.229cea25.js";import{d as B,b as h,r as E,w as F,T as R,N as S,aj as g,e as c,t as I,o as n,f as u,g as M,j as d,k as f,F as N,y as j,v as D,x as _,u as T}from"./element-plus.59ccb443.js";import{r as q}from"./login.a4e9287e.js";import{S as G}from"./Frame.1a41abcb.js";import"./lodash.22f463b4.js";import"../../app-config.js";function $(p){return q.doGetPromise(`/certification/manager/monitor/${p}`)}const z={id:"server-monitor-container",class:"common-flex-container"},A={class:"top-toolbar"},H={class:"app-iframe",style:{flex:"1",overflow:"hidden"}},J=B({__name:"index",setup(p){const l=C(),t=h(""),m=h(!1),a=E({monitorList:[],form:{instance:""}}),k=F(()=>l.name,o=>{o&&v()},{flush:"post"});R(()=>{k()}),S(()=>{v()});function v(){var i;if(m.value=!0,!((i=l.meta)!=null&&i.iframeUrl))return;t.value=l.meta.iframeUrl;const o=new URL(t.value),e=o.searchParams.get("sgeoc-api");e&&L(e);const r=o.searchParams.get("var-instance");r&&(a.form.instance=r)}function L(o){$(o).then(e=>{e.code==="0000"?a.monitorList=e.data:g({type:"error",message:e.message||"获取监控服务器列表失败"})}).catch(e=>{g({type:"error",message:e.message||"获取监控服务器列表错误"})})}function x(){m.value=!1}function y(){const o=new URL(t.value);o.searchParams.set("var-instance",a.form.instance);const e=decodeURIComponent(o.href);t.value=e.replace(/kiosk=/,"kiosk")}return(o,e)=>{const r=c("el-option"),i=c("el-select"),w=c("el-form-item"),U=c("el-form"),b=I("loading");return n(),u("div",z,[M("div",A,[d(U,{inline:!0,class:"commonSearchForm"},{default:f(()=>[d(w,{label:"服务器实例 :"},{default:f(()=>[d(i,{modelValue:a.form.instance,"onUpdate:modelValue":e[0]||(e[0]=s=>a.form.instance=s),class:"search-select",onChange:y},{default:f(()=>[(n(!0),u(N,null,j(a.monitorList,s=>(n(),_(r,{key:s.nodename,label:s.instance,value:s.instance},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),D((n(),u("div",H,[t.value?(n(),_(T(G),{key:1,url:t.value,onLoad:x},null,8,["url"])):(n(),_(P,{key:0}))])),[[b,m.value]])])}}});const Z=V(J,[["__scopeId","data-v-a09c697d"]]);export{Z as default};
