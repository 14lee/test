import{d as me,b as I,r as re,w as ye,e as y,t as ne,o as s,x as m,k as o,g as i,j as r,B as h,u as n,v as E,f as b,U as ce,F as Z,y as be,l as _,z as G,ad as J,ae as ve,n as De,aj as P,ai as L,N as ge,S as Ce,ak as pe}from"./element-plus.59ccb443.js";import{v as C}from"./lodash.22f463b4.js";import{D as u,d as we,S as ke,f as T}from"./index.vue_vue_type_style_index_0_scoped_7b7c1886_lang.2666f209.js";import{t as Ve,x as Se,y as Ee,z as Te,A as xe,v as ze}from"./login.a4e9287e.js";import{a7 as he}from"./index-a95bb620.js";import"./error.229cea25.js";import"../../app-config.js";import"./echarts.39e3cf74.js";import"./wujie-vue3.9ecbe737.js";import"./smartweb3.2d5e4c59.js";import"./smart-ui.e8e0134c.js";const Xe={class:"main-content"},Ye={class:"title"},Pe={class:"card"},He=i("div",{class:"subtitle"},"基本信息",-1),Be={class:"content-wrap"},Le={class:"item-wrap"},Oe={key:1},Ue={class:"item-wrap"},Ke={class:"left-item common-flex"},$e=i("span",{class:"label"},"宽：",-1),qe={key:1,class:"text"},Ge=i("span",{class:"unit"},"px",-1),Ie=i("span",{class:"slider"}," —— ",-1),Fe={class:"right-item common-flex"},Re=i("span",{class:"label"},"高：",-1),Ae={key:1,class:"text"},Ne=i("span",{class:"unit"},"px",-1),Me={class:"item-wrap"},We={class:"list-item"},je=i("span",null," — — ",-1),Ze={key:1},Je={class:"item-wrap"},Qe={class:"rangeContainer top"},et=i("div",{class:"labelName"},"边界X：",-1),tt={class:"input"},at=i("span",{class:"slider"}," —— ",-1),it={class:"rangeContainer"},lt=i("div",{class:"labelName"},"边界Y：",-1),ot={class:"input"},st=i("span",{class:"slider"}," —— ",-1),nt={class:"rangeContainer top"},rt=i("div",{class:"labelName"},"边界X：",-1),dt={class:"input text"},ut=i("span",{class:"slider"}," —— ",-1),ct={class:"rangeContainer"},pt=i("div",{class:"labelName"},"边界Y：",-1),mt={class:"input text"},gt=i("span",{class:"slider"}," —— ",-1),ht={class:"item-wrap"},ft={key:1},_t={class:"card"},yt=i("div",{class:"subtitle"},"瓦片矩阵集设置",-1),bt={class:"content-wrap"},vt={class:"item-wrap"},Dt={key:1},Ct={class:"item-wrap"},wt={class:"table content-wrap"},kt=i("p",null,[i("span",{style:{"font-size":"16px",color:"#ff8282"}},"*"),_(" 像素大小 ")],-1),Vt={key:1},St=i("p",null,[i("span",{style:{"font-size":"16px",color:"#ff8282"}},"*"),_(" 比例尺 ")],-1),Et=i("div",{class:"lebel"},"1 ：",-1),Tt={key:1},xt=i("p",null,[i("span",{style:{"font-size":"16px",color:"#ff8282"}},"*"),_(" 名称 ")],-1),zt={key:1},Xt=["onClick"],Yt=i("div",{id:"anchorPoint",style:{overflow:"hidden"}},null,-1),Pt={class:"footer"},Ht=me({__name:"GridInfoDialog",props:{visible:{type:Boolean,default:!1},dialogType:{default:u.CHECK},domId:{default:""},curEditData:{default:()=>{}}},emits:["update:visible","changeEdit","save"],setup(F,{emit:O}){const{checkPermission:R}=he(),H=I(),S=I(),A=I(),N=I(),D=F,B=O,e=re({isCopy:!1,isLoading:!1,dialogVisible:!1,submiting:!1,initData:{id:"",srs:"EPSG:4326",name:"",description:"",tileSize:{width:256,height:256},resolutionsPreserved:!0,range:{maxX:180,maxY:90,minX:-180,minY:-90},resolutions:[]},editData:{tileSize:{width:256,height:256},range:{maxX:180,maxY:90,minX:-180,minY:-90},resolutions:[]},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{min:0,max:50,message:"长度在 50 个字符以内",trigger:["blur","change"]}],tileSize:{type:"object",required:!0,fields:{width:{type:"number",required:!0,message:"瓦片尺寸不能为空",trigger:["blur","change"]},height:{type:"number",required:!0,message:"瓦片尺寸不能为空",trigger:["blur","change"]}}},range:{type:"object",required:!0,fields:{minX:{type:"number",required:!0,message:"网格集范围不能为空",trigger:["blur","change"]},minY:{type:"number",required:!0,message:"网格集范围不能为空",trigger:["blur","change"]},maxX:{type:"number",required:!0,message:"网格集范围不能为空",trigger:["blur","change"]},maxY:{type:"number",required:!0,message:"网格集范围不能为空",trigger:["blur","change"]}}},description:[{min:0,max:100,message:"长度在 100 个字符以内",trigger:["blur","change"]}],resolutionsPreserved:[{required:!0,message:"网格模式为空",trigger:"change"}],resolutions:{type:"array",required:!0,message:"瓦片缩放级别不能为空"}},srsOptions:[],copySrsOptions:[],resolutionRules:{resolution:[{required:!0,message:"像素大小不能为空",trigger:["blur","change"]}],scale:[{required:!0,message:"比例尺不能为空",trigger:["blur","change"]}],name:[{required:!0,message:"名称不能为空",trigger:["blur","change"]}]},selection:[],isLoadingTable:!1});ye(()=>D.visible,a=>{e.dialogVisible=a});function Q(){e.isCopy=!1,D.dialogType===u.ADD?D.curEditData.id?(e.isCopy=!0,M(D.curEditData.id)):e.editData=C(e.initData):M(D.curEditData.id),x(),De(()=>{H.value.clearValidate(),S.value.clearValidate()})}function z(){B("update:visible",!1),e.editData.resolutions=[]}function ee(){B("changeEdit")}function M(a){e.isLoading=!0,T.getGridInfoById(a).then(t=>{if(t.code==="0000"){e.editData=C(e.initData);for(const d in e.initData)e.editData[d]=t.data[d];e.editData.tileSize={width:t.data.tileWidth,height:t.data.tileHeight};const{minX:c,maxX:k,minY:f,maxY:p}=t.data;e.editData.range={minX:c,maxX:k,minY:f,maxY:p},e.editData.resolutions.forEach((d,v)=>{d.level=v}),e.editData.srs=`EPSG:${t.data.srs}`,e.isCopy&&(e.editData.id="",e.editData.name="")}else P({type:"error",message:"获取信息失败"}),z()}).catch(()=>{P({type:"error",message:"获取信息错误"}),z()}).finally(()=>{e.isLoading=!1})}function x(){R("mapserver_gridsets_srsenums")&&T.getSrsList().then(a=>{a.code==="0000"?(e.srsOptions=a.data,e.srsOptions.forEach(t=>{t.value=`EPSG:${t.value}`})):(e.srsOptions=[],P({type:"error",message:"获取坐标系统失败"}))}).catch(()=>{e.srsOptions=[],P({type:"error",message:"获取坐标系统错误"})}).finally(()=>{e.copySrsOptions=C(e.srsOptions)})}function W(a){a?e.srsOptions=C(e.copySrsOptions).filter(t=>t.label.toLowerCase().includes(a.toLowerCase())||t.value.toLowerCase().includes(a.toLowerCase())):e.srsOptions=C(e.copySrsOptions)}function g(a){R("mapserver_gridsets_getSrsBoungding")&&T.getSrsBoungding(a).then(t=>{if(t.code==="0000"){if(t.data){const{maxX:c,maxY:k,minX:f,minY:p}=t.data;e.editData.range={minX:f,maxX:c,minY:p,maxY:k},setTimeout(()=>{U()},100)}}else P({type:"error",message:"获取网格集范围"})}).catch(()=>{e.srsOptions=[],P({type:"error",message:"获取网格集范围"})})}function te(a){e.editData.resolutions=e.editData.resolutions.filter(t=>t.level!==a.level),e.editData.resolutions.forEach((t,c)=>{t.level=c}),S.value.validateField("resolutions")}function ae(){e.editData.resolutions=e.editData.resolutions.filter(a=>e.selection.every(t=>t!==a.level)),e.editData.resolutions.forEach((a,t)=>{a.level=t}),e.selection=[],S.value.validateField("resolutions")}function ie(){e.editData.resolutions||(e.editData.resolutions=[]),U(!0)}function j(a,t,c){t[c]=a.target.value}function w(a){a&&e.editData.resolutions.length!==0&&U()}function U(a=!1){const t=a?"addZoomLevel":"updateZoomLevel",c=C(e.editData.resolutions),k={srs:e.editData.srs.replace("EPSG:",""),minX:e.editData.range.minX,maxX:e.editData.range.maxX,minY:e.editData.range.minY,maxY:e.editData.range.maxY,tileHeight:e.editData.tileSize.height,tileWidth:e.editData.tileSize.width,resolutionsPreserved:e.editData.resolutionsPreserved,list:c};e.isLoadingTable=!0,T[t](k).then(f=>{e.isLoadingTable=!1,f.code==="0000"?(e.editData.resolutions=[...f.data],e.editData.resolutions.forEach((p,d)=>{p.level=d}),a&&(S.value.validateField("resolutions"),setTimeout(()=>{N.value.querySelector("#anchorPoint").scrollIntoView()},100))):P({type:"warning",message:f.data})}).catch(()=>{e.isLoadingTable=!1})}function le(a){e.selection=a.map(t=>t.level)}function K(a){return new Promise(t=>{a.validate(c=>{t(c)})})}function oe(){const a=K(H.value),t=K(S.value),c=K(A.value);Promise.all([a,t,c]).then(([f,p,d])=>{if(f&&p&&d){const v=C(e.editData.resolutions),se={id:D.dialogType===u.ADD?"":e.editData.id,name:e.editData.name,description:e.editData.description,srs:e.editData.srs.replace("EPSG:",""),minX:e.editData.range.minX,maxX:e.editData.range.maxX,minY:e.editData.range.minY,maxY:e.editData.range.maxY,tileHeight:e.editData.tileSize.height,tileWidth:e.editData.tileSize.width,resolutionsPreserved:e.editData.resolutionsPreserved,resolutions:v};e.submiting=!0;const $=D.dialogType===u.ADD?"addGrid":"updateGridInfo";T[$](se).then(X=>{e.submiting=!1,X.code==="0000"?(L({type:"success",title:`${D.dialogType===u.ADD?"新增":"保存"}成功`}),z(),B("save")):L({type:"error",title:`${D.dialogType===u.ADD?"新增":"保存"}失败`,message:X.message})}).catch(X=>{e.submiting=!1,L({type:"error",title:`${D.dialogType===u.ADD?"新增":"保存"}错误`,message:X.message})})}})}return(a,t)=>{const c=y("ArrowLeft"),k=y("el-icon"),f=y("el-input"),p=y("el-form-item"),d=y("el-input-number"),v=y("el-option"),se=y("el-select"),$=y("el-form"),X=y("el-radio"),fe=y("el-radio-group"),q=y("el-button"),Y=y("el-table-column"),_e=y("el-table"),de=ne("loading"),ue=ne("action");return s(),m(n(ke),{id:"grid-full-dialog",modelValue:e.dialogVisible,"onUpdate:modelValue":t[11]||(t[11]=l=>e.dialogVisible=l),class:"full-dialog common-full-dialog","append-to-dom":a.domId,"modal-append-to-body":!1,fullscreen:"","is-custom":"","close-on-press-escape":!1,onOpen:Q,onClosed:z},{default:o(()=>[i("div",Xe,[i("div",Ye,[r(k,{onClick:z},{default:o(()=>[r(c)]),_:1}),i("span",null,h((n(we).get(a.dialogType)||"查看")+"网格集"),1)]),E((s(),b("div",{ref_key:"mainRef",ref:N,class:"main"},[i("div",Pe,[He,i("div",Be,[r($,{ref_key:"editForm",ref:H,class:"form edit-form",inline:"",model:e.editData,rules:e.rules,"label-width":"auto","label-position":"right"},{default:o(()=>[i("div",Le,[r(p,{label:"网格集名称",prop:"name"},{default:o(()=>[a.dialogType!==n(u).CHECK?(s(),m(f,{key:0,modelValue:e.editData.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.editData.name=l),type:"text",placeholder:"请输入网格集名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])):(s(),b("span",Oe,h(e.editData.name),1))]),_:1})]),i("div",Ue,[r(p,{label:"瓦片尺寸",prop:"tileSize"},{default:o(()=>[i("div",{class:ce(["tileSizeContainer",{text:a.dialogType===n(u).CHECK}])},[i("div",Ke,[$e,a.dialogType!==n(u).CHECK?(s(),m(d,{key:0,modelValue:e.editData.tileSize.width,"onUpdate:modelValue":t[1]||(t[1]=l=>e.editData.tileSize.width=l),placeholder:"请输入瓦片尺寸宽","controls-position":"right",max:2048,min:16,onChange:w},null,8,["modelValue"])):(s(),b("span",qe,h(e.editData.tileSize.width),1)),Ge]),Ie,i("div",Fe,[Re,a.dialogType!==n(u).CHECK?(s(),m(d,{key:0,modelValue:e.editData.tileSize.height,"onUpdate:modelValue":t[2]||(t[2]=l=>e.editData.tileSize.height=l),placeholder:"请输入瓦片尺寸高","controls-position":"right",max:2048,min:16,onChange:w},null,8,["modelValue"])):(s(),b("span",Ae,h(e.editData.tileSize.height),1)),Ne])],2)]),_:1})]),i("div",Me,[r(p,{key:"srs",label:"坐标系统",prop:"srs",rules:{required:!0,message:"坐标系统不能为空",trigger:"change"}},{default:o(()=>[a.dialogType!==n(u).CHECK?(s(),m(se,{key:0,modelValue:e.editData.srs,"onUpdate:modelValue":t[3]||(t[3]=l=>e.editData.srs=l),style:{width:"100%"},"popper-class":"srs-select",filterable:"","filter-method":W,placeholder:"请选择坐标系统",onChange:g},{default:o(()=>[(s(!0),b(Z,null,be(e.srsOptions,l=>(s(),m(v,{key:l.value,label:l.value,value:l.value},{default:o(()=>[i("div",We,[i("span",null,h(l.value),1),je,i("span",null,h(l.label),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])):(s(),b("span",Ze,h(e.editData.srs),1))]),_:1})]),i("div",Je,[r(p,{label:"网格集范围",prop:"range"},{default:o(()=>[a.dialogType!==n(u).CHECK?(s(),b(Z,{key:0},[i("div",Qe,[et,i("div",tt,[r(d,{modelValue:e.editData.range.minX,"onUpdate:modelValue":t[4]||(t[4]=l=>e.editData.range.minX=l),"controls-position":"right",placeholder:"请输入最小X",onChange:w},null,8,["modelValue"]),at,r(d,{modelValue:e.editData.range.maxX,"onUpdate:modelValue":t[5]||(t[5]=l=>e.editData.range.maxX=l),"controls-position":"right",placeholder:"请输入最大X",onChange:w},null,8,["modelValue"])])]),i("div",it,[lt,i("div",ot,[r(d,{modelValue:e.editData.range.minY,"onUpdate:modelValue":t[6]||(t[6]=l=>e.editData.range.minY=l),"controls-position":"right",placeholder:"请输入最小Y",onChange:w},null,8,["modelValue"]),st,r(d,{modelValue:e.editData.range.maxY,"onUpdate:modelValue":t[7]||(t[7]=l=>e.editData.range.maxY=l),"controls-position":"right",placeholder:"请输入最大Y",onChange:w},null,8,["modelValue"])])])],64)):(s(),b(Z,{key:1},[i("div",nt,[rt,i("div",dt,[i("span",null,h(e.editData.range.minX),1),ut,i("span",null,h(e.editData.range.maxX),1)])]),i("div",ct,[pt,i("div",mt,[i("span",null,h(e.editData.range.minY),1),gt,i("span",null,h(e.editData.range.maxY),1)])])],64))]),_:1})]),i("div",ht,[r(p,{label:"网格集说明",prop:"description"},{default:o(()=>[a.dialogType!==n(u).CHECK?(s(),m(f,{key:0,modelValue:e.editData.description,"onUpdate:modelValue":t[8]||(t[8]=l=>e.editData.description=l),type:"text",placeholder:"请输入说明",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue"])):(s(),b("span",ft,h(e.editData.description),1))]),_:1})])]),_:1},8,["model","rules"])])]),i("div",_t,[yt,i("div",bt,[r($,{ref_key:"editMatrixForm",ref:S,class:"table-form edit-form",inline:"",model:e.editData,rules:e.rules,"label-width":"auto","label-position":"right"},{default:o(()=>[i("div",vt,[r(p,{label:"网格模式",prop:"resolutionsPreserved"},{default:o(()=>[a.dialogType!==n(u).CHECK?(s(),m(fe,{key:0,modelValue:e.editData.resolutionsPreserved,"onUpdate:modelValue":t[9]||(t[9]=l=>e.editData.resolutionsPreserved=l)},{default:o(()=>[r(X,{label:!0},{default:o(()=>[_("地图分辨率")]),_:1}),r(X,{label:!1},{default:o(()=>[_("地图比例尺")]),_:1})]),_:1},8,["modelValue"])):(s(),b("span",Dt,h(e.editData.resolutionsPreserved?"地图分辨率":"地图比例尺"),1))]),_:1})]),i("div",Ct,[r(p,{key:"resolutions",label:"瓦片缩放级别",prop:"resolutions"},{default:o(()=>[a.dialogType!==n(u).CHECK?(s(),m(q,{key:0,type:"primary",text:"",onClick:ie},{default:o(()=>[_(" 添加缩放级别 ")]),_:1})):G("",!0),a.dialogType!==n(u).CHECK?(s(),m(q,{key:1,style:{"margin-left":"24px"},disabled:e.selection.length===0,type:"primary",text:"",onClick:ae},{default:o(()=>[_("删除勾选")]),_:1},8,["disabled"])):G("",!0)]),_:1})])]),_:1},8,["model","rules"])]),E(i("div",wt,[r($,{ref_key:"tableForm",ref:A,class:"table-form edit-form",model:e.editData},{default:o(()=>[E((s(),m(_e,{ref:"resolutionsTable",class:"resolutionsTable",data:e.editData.resolutions,"row-key":"level",onSelectionChange:le},{default:o(()=>[a.dialogType!==n(u).CHECK?(s(),m(Y,{key:0,align:"center",type:"selection",label:"选中",selectable:()=>a.dialogType!==n(u).CHECK},null,8,["selectable"])):G("",!0),r(Y,{align:"center",prop:"level",label:"级别",width:"60"}),r(Y,{prop:"resolution","min-width":"120"},{header:o(()=>[kt]),default:o(l=>[a.dialogType!==n(u).CHECK&&e.editData.resolutionsPreserved?(s(),m(p,{key:0,prop:"resolutions."+l.$index+".resolution",rules:e.resolutionRules.resolution},{default:o(()=>[r(f,{modelValue:l.row.resolution,"onUpdate:modelValue":V=>l.row.resolution=V,modelModifiers:{trim:!0},placeholder:"请输入像素大小",oninput:"value=value.replace(/^\\.+|[^\\d.]/g,'')",onBlur:V=>j(V,l.row,"resolution"),onChange:w},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),_:2},1032,["prop","rules"])):(s(),b("span",Vt,h(l.row.resolution),1))]),_:1}),r(Y,{prop:"scale","min-width":"120"},{header:o(()=>[St]),default:o(l=>[a.dialogType!==n(u).CHECK&&!e.editData.resolutionsPreserved?(s(),m(p,{key:0,class:"scale-form-item",prop:"resolutions."+l.$index+".scale",rules:e.resolutionRules.scale},{default:o(()=>[Et,r(f,{modelValue:l.row.scale,"onUpdate:modelValue":V=>l.row.scale=V,modelModifiers:{trim:!0},placeholder:"请输入比例尺",oninput:"value=value.replace(/^\\.+|[^\\d.]/g,'')",onBlur:V=>j(V,l.row,"scale"),onChange:w},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),_:2},1032,["prop","rules"])):(s(),b("span",Tt,"1 : "+h(l.row.scale),1))]),_:1}),r(Y,{prop:"name","min-width":"120"},{header:o(()=>[xt]),default:o(l=>[a.dialogType!==n(u).CHECK?(s(),m(p,{key:0,prop:"resolutions."+l.$index+".name",rules:e.resolutionRules.name},{default:o(()=>[r(f,{modelValue:l.row.name,"onUpdate:modelValue":V=>l.row.name=V,placeholder:"请输入名称"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])):(s(),b("span",zt,h(l.row.name),1))]),_:1}),r(Y,{prop:"tiles",label:"瓦片尺寸","min-width":"120"},{default:o(l=>[_(h(l.row.tiles),1)]),_:1}),a.dialogType!==n(u).CHECK?(s(),m(Y,{key:1,width:"60px",label:"操作",align:"center",fixed:"right","class-name":"tableOperate"},{default:o(l=>[i("span",{class:ce([{disabled:e.editData.resolutions&&e.editData.resolutions.length<=1},"delete"]),onClick:J(V=>te(l.row),["stop"])},"删除",10,Xt)]),_:1})):G("",!0)]),_:1},8,["data"])),[[de,e.isLoadingTable]])]),_:1},8,["model"])],512),[[ve,e.editData.resolutions&&e.editData.resolutions.length!==0]]),Yt])])),[[de,e.isLoading]]),i("div",Pt,[r(q,{onClick:t[10]||(t[10]=l=>e.dialogVisible=!1)},{default:o(()=>[_("取消")]),_:1}),a.dialogType!==n(u).CHECK?E((s(),m(q,{key:0,type:"primary",loading:e.submiting,onClick:oe},{default:o(()=>[_("保存")]),_:1},8,["loading"])),[[ue,"mapserver_gridsets_update"]]):(s(),b(Z,{key:1},[a.curEditData.default?G("",!0):E((s(),m(q,{key:0,type:"primary",onClick:ee},{default:o(()=>[_(" 编辑 ")]),_:1})),[[ue,"mapserver_gridsets_update"]])],64))])])]),_:1},8,["modelValue","append-to-dom"])}}});function Bt(){const F=re({searchOptions:[{label:"关键字",key:"keyword",type:"text",placeholder:"名称/EPSG编码",span:5},{label:"网络集状态",key:"enable",type:"select",options:[{label:"所有",value:""},{label:"启动",value:1},{label:"禁用",value:0}],clearable:!0,span:5}],columns:[{prop:"name",label:"网格集名称",minWidth:120,slot:"name"},{prop:"srs",label:"坐标系统",minWidth:120},{prop:"tileCount",label:"瓦片尺寸",minWidth:120},{prop:"scaleLevel",label:"缩放等级",minWidth:120},{prop:"enable",label:"网格集状态",minWidth:120,slot:"enable"}]}),O=async()=>{};return ge(async()=>{O()}),{...Ce(F)}}const Nt=me({__name:"index",setup(F){const{searchOptions:O,columns:R}=Bt(),H=I(),{data:S,total:A,pageNo:N,pageSize:D,multipleSelection:B,loading:e,handleSizeChange:Q,handleCurrentChange:z,handleSelectionChange:ee,handleSearch:M,initData:x}=Ve(T.getGridsPageList),{checkPermission:W}=he(),g=re({domId:"grid-setting-management",dialogVisible:!1,dialogType:u.CHECK,curEditData:{}});ge(()=>{x()});function te(a){return!a.default}function ae(){g.curEditData={},g.dialogType=u.ADD,g.dialogVisible=!0}function ie(a,t){S.value.length!==0&&T.changeGridStatus(t.id,t.enable).then(c=>{c.code==="0000"&&L({title:"提示",message:`网格集已${t.enable?"启动":"禁用"}！`,type:"success",duration:2e3}),x()}).catch(()=>{x()})}function j(a){W("mapserver_gridsets_info")&&(g.curEditData=C(a),g.dialogType=u.CHECK,g.dialogVisible=!0)}function w(a){g.curEditData=C(a),g.dialogType=u.ADD,g.dialogVisible=!0}function U(a,t){t||(g.curEditData=C(a),g.dialogType=u.EDIT,g.dialogVisible=!0)}function le(){g.dialogType=u.EDIT}function K(a,t){t||pe.confirm(`删除【${a.name}】网格集, 是否继续?`,"提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then(()=>{e.value=!0,T.deleteGridByIds(a.id).then(c=>{e.value=!1,c.code==="0000"&&(L({type:"success",title:"删除网格集成功"}),x(),B.value=[])}).catch(()=>{e.value=!1})}).catch(()=>{})}function oe(){pe.confirm("是否批量删除选中网格集?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{e.value=!0;const t=C(B.value).map(c=>c.id).join(",");T.deleteGridByIds(t).then(c=>{e.value=!1,c.code==="0000"&&(L({type:"success",title:"批量删除网格集成功"}),x())}).catch(()=>{e.value=!1})}).catch(()=>{})}return(a,t)=>{const c=y("el-button"),k=y("el-link"),f=y("el-switch"),p=ne("action");return s(),m(n(ze),{id:"grid-setting-management",background:""},{default:o(()=>[r(n(Se),{padding:"1 1 0",border:"",justify:"space-between"},{default:o(()=>[r(n(Ee),{ref_key:"SmartSearchRef",ref:H,options:n(O),onHandleSearch:n(M)},null,8,["options","onHandleSearch"])]),_:1}),r(n(Te),null,{default:o(()=>[r(n(xe),{ref:"baseTable","operation-width":"220",columns:n(R),"table-data":n(S),"current-page":n(N),"page-size":n(D),total:n(A),"pagination-is-need":!0,"operation-is-need":!0,loading:n(e),"search-form-ref":H.value,"selection-is-need":!0,"index-is-need":!1,"column-selectable":te,onSizeChange:n(Q),onCurrentChange:n(z),onSelectionChange:n(ee)},{"smart-table_operation":o(()=>[E((s(),m(c,{type:"primary",onClick:ae},{default:o(()=>[_(" 新增 ")]),_:1})),[[p,"mapserver_gridsets_add"]])]),"smart-table_batch-operation":o(()=>[r(c,{link:"",type:"danger",onClick:oe},{default:o(()=>[_(" 批量删除 ")]),_:1})]),name:o(({scope:d})=>[r(k,{type:"primary",onClick:v=>j(d.row)},{default:o(()=>[_(h(d.row.name),1)]),_:2},1032,["onClick"])]),enable:o(({scope:d})=>[r(f,{modelValue:d.row.enable,"onUpdate:modelValue":v=>d.row.enable=v,class:"swith-btn","active-value":!0,"inactive-value":!1,disabled:!n(W)("mapserver_gridsets_enable"),onChange:v=>ie(v,d.row)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])]),operation:o(({scope:d})=>[E((s(),m(c,{type:"primary",link:"",onClick:J(v=>w(d.row),["stop"])},{default:o(()=>[_(" 复制 ")]),_:2},1032,["onClick"])),[[p,"mapserver_gridsets_add"]]),E((s(),m(c,{link:"",type:"primary",disabled:d.row.default,onClick:J(v=>U(d.row,d.row.default),["stop"])},{default:o(()=>[_("编辑")]),_:2},1032,["disabled","onClick"])),[[p,"mapserver_gridsets_update"]]),E((s(),m(c,{type:"danger",link:"",disabled:d.row.default,onClick:J(v=>K(d.row,d.row.default),["stop"])},{default:o(()=>[_("删除")]),_:2},1032,["disabled","onClick"])),[[p,"mapserver_gridsets_delete"]])]),_:1},8,["columns","table-data","current-page","page-size","total","loading","search-form-ref","onSizeChange","onCurrentChange","onSelectionChange"])]),_:1}),r(Ht,{visible:g.dialogVisible,"onUpdate:visible":t[0]||(t[0]=d=>g.dialogVisible=d),"dom-id":g.domId,"dialog-type":g.dialogType,"cur-edit-data":g.curEditData,onSave:n(x),onChangeEdit:le},null,8,["visible","dom-id","dialog-type","cur-edit-data","onSave"])]),_:1})}}});export{Nt as default};
