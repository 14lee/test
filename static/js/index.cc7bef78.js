import{q as y}from"./lodash.22f463b4.js";import{i as U}from"./index-a95bb620.js";import{i as v,b as M,G as O,C as I}from"./index.vue_vue_type_style_index_0_scoped_7b7c1886_lang.2666f209.js";import{d as K,V as Y,p as j,c as G,r as J,w as X,N as $,aj as L,e as p,o as t,f as g,x as s,k as q,F as P,y as F,u as C,j as H,g as _,B as z,z as S}from"./element-plus.59ccb443.js";import"./login.a4e9287e.js";const Q={key:1,style:{width:"100%"}},W={style:{"margin-left":"16px"}},Z=K({__name:"index",props:{modelValue:{},allParam:{default:()=>({})},relations:{default:()=>[]},defaultDataInfo:{default:()=>({srs:"",srsOrigin:"",rotate:0})},isBatchData:{type:Boolean,default:!1}},emits:["change","getDataList"],setup(A,{emit:N}){const o=A,E=N,f=Y(),h=f["control-name"];j("$uid",G(()=>f.uid));const e=J({options:[],cascaderKey:1,bindValue:"",treeProps:{label:"name",children:"children"},groupIdentify:{}});X(()=>o.modelValue,()=>{k()}),$(()=>{k()}),o.allParam.controlType==="SELECT_TREE"?e.bindValue={}:o.allParam.paramTypeEnums==="NUMBER"&&(e.bindValue=0);function k(){const{controlType:a,paramTypeEnums:l,dataSourceItems:m=[],multiple:r,paramDirection:u,requestUrl:b="",paramLabel:c}=o.allParam;a==="SELECT"&&(l==="TEXT"||l==="NUMBER")?e.bindValue="":e.bindValue=y.cloneDeep(o.modelValue),a==="SELECT"&&(l==="TEXT"||l==="NUMBER")?R(b,m,c).then(T=>{e.options=y.cloneDeep(T),e.bindValue=y.cloneDeep(o.modelValue),r?(o.modelValue?typeof o.modelValue=="string"?e.bindValue=o.modelValue.split(",").filter(V=>V):e.bindValue=[]:e.bindValue=[],e.bindValue=e.bindValue.filter(V=>e.options.some(n=>n.value===V))):(l!=="NUMBER"&&typeof o.modelValue!="string"||e.options.every(V=>V.value!==e.bindValue))&&(e.bindValue="")}):a==="SELECT"&&l==="FIELD"?r?(o.modelValue?typeof o.modelValue=="string"?e.bindValue=o.modelValue.split(",").filter(d=>d):e.bindValue=[]:e.bindValue=[],e.bindValue=e.bindValue.filter(d=>e.options.some(T=>T.value===d))):(typeof o.modelValue!="string"||e.options.every(d=>d.value!==e.bindValue))&&(e.bindValue=""):a==="SELECT"&&l==="DATASOURCE"||a==="SELECT"&&l==="LAYER"?typeof o.modelValue!="string"&&(e.bindValue=""):a==="SELECT_TREE"&&l==="TEMPLATE"?(e.groupIdentify={key:"type",value:0},e.options=[],o.modelValue&&U(o.modelValue)&&(e.bindValue=JSON.parse(o.modelValue))):a==="CASCADER"&&(++e.cascaderKey,e.options=[],o.modelValue?typeof o.modelValue=="string"?e.bindValue=o.modelValue.split(",").filter(d=>d):e.bindValue=[]:e.bindValue=[],D(!0))}function D(a){a&&(e.options=[])}function i(){const{controlType:a,paramTypeEnums:l,multiple:m}=o.allParam;a==="SELECT_TREE"&&l==="TEMPLATE"||(a==="CASCADER"?e.bindValue&&E("change",e.bindValue.join(","),h,f.uid):m?E("change",e.bindValue.join(","),h,f.uid):E("change",e.bindValue,h,f.uid))}function B(a){e.bindValue=y.cloneDeep(a),E("change",JSON.stringify(e.bindValue),h,f.uid)}function R(a,l,m){return new Promise(r=>{a?v.getDataByUrl(a).then(u=>{var b,c;u.code==="0000"?Array.isArray(u==null?void 0:u.data)&&((b=u.data[0])!=null&&b.label)&&((c=u.data[0])!=null&&c.value)?r(u.data):r([]):(r([]),L({type:"error",message:`获取 " ${m} " 下拉选项数据失败`}))}).catch(()=>{r([]),L({type:"error",message:`获取 " ${m} " 下拉选项数据失败`})}):r(l)})}function w(a){E("getDataList",l=>{a(l)})}return(a,l)=>{const m=p("el-option"),r=p("el-select"),u=p("el-input-number"),b=p("el-color-picker"),c=p("el-input"),d=p("el-checkbox"),T=p("el-date-picker"),V=p("el-cascader");return t(),g("div",null,[a.allParam.controlType==="SELECT"?(t(),s(r,{key:0,modelValue:e.bindValue,"onUpdate:modelValue":l[0]||(l[0]=n=>e.bindValue=n),style:{width:"100%"},placeholder:a.allParam.paramTip,multiple:a.allParam.multiple,filterable:"","allow-create":a.allParam.editable,onChange:i},{default:q(()=>[(t(!0),g(P,null,F(e.options,n=>(t(),s(m,{key:n.value,label:n.label,value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","multiple","allow-create"])):a.allParam.controlType==="INPUT_BOX"?(t(),g(P,{key:1},[a.allParam.paramTypeEnums==="NUMBER"?(t(),s(u,{key:0,ref:"inputBox",modelValue:e.bindValue,"onUpdate:modelValue":l[1]||(l[1]=n=>e.bindValue=n),style:{width:"100%"},"controls-position":"right",max:C(y.isNumber)(a.allParam.max)?a.allParam.max:1/0,min:C(y.isNumber)(a.allParam.min)?a.allParam.min:-1/0,placeholder:a.allParam.paramTip,onBlur:i,onChange:i},null,8,["modelValue","max","min","placeholder"])):a.allParam.paramTypeEnums==="COLOR"?(t(),g("div",Q,[H(b,{modelValue:e.bindValue,"onUpdate:modelValue":l[2]||(l[2]=n=>e.bindValue=n),"color-format":"rgb","show-alpha":!0,onChange:i},null,8,["modelValue"]),_("span",W,z(e.bindValue),1)])):(t(),s(c,{key:2,ref:"inputBox",modelValue:e.bindValue,"onUpdate:modelValue":l[3]||(l[3]=n=>e.bindValue=n),style:{width:"100%"},placeholder:a.allParam.paramTip,onBlur:i},null,8,["modelValue","placeholder"]))],64)):a.allParam.controlType==="SELECT_TREE"?(t(),s(C(M),{key:2,modelValue:e.bindValue,"onUpdate:modelValue":l[4]||(l[4]=n=>e.bindValue=n),"tree-props":e.treeProps,"tree-data":e.options,"node-key":"id",icon:"iconCls",style:{width:"100%"},"expand-on-click-node":!1,"default-expand-all":"",filterable:"","only-click-child":"","show-group-icon":"","group-identify":e.groupIdentify,onChange:i},null,8,["modelValue","tree-props","tree-data","group-identify"])):a.allParam.controlType==="CHECK_BOX"?(t(),s(d,{key:3,modelValue:e.bindValue,"onUpdate:modelValue":l[5]||(l[5]=n=>e.bindValue=n),onChange:i},null,8,["modelValue"])):a.allParam.controlType==="DATETIMEPICKER"?(t(),s(T,{key:4,modelValue:e.bindValue,"onUpdate:modelValue":l[6]||(l[6]=n=>e.bindValue=n),style:{width:"100%"},type:"datetime",placeholder:a.allParam.paramTip,"value-format":"YYYY-MM-DD HH:mm:ss",onChange:i,onBlur:i},null,8,["modelValue","placeholder"])):a.allParam.controlType==="CASCADER"?(t(),s(V,{key:e.cascaderKey,modelValue:e.bindValue,"onUpdate:modelValue":l[7]||(l[7]=n=>e.bindValue=n),style:{width:"100%"},props:{multiple:a.allParam.multiple},options:e.options,onChange:i,onVisibleChange:D},null,8,["modelValue","props","options"])):a.allParam.controlType==="TABLE"?(t(),g(P,{key:6},[a.allParam.paramTypeEnums==="GEO_SRS"?(t(),s(C(O),{key:0,"init-data":e.bindValue,"control-name":a.allParam.paramName,"control-params":a.allParam,"default-data-info":a.defaultDataInfo,"is-batch-data":a.isBatchData,onChangeTable:B,onGetDataList:w},null,8,["init-data","control-name","control-params","default-data-info","is-batch-data"])):S("",!0),a.allParam.paramTypeEnums==="COORDINATE_PARAMS"?(t(),s(C(I),{key:1,"control-name":a.allParam.paramName,"control-params":a.allParam,onChangeTable:B},null,8,["control-name","control-params"])):S("",!0)],64)):S("",!0)])}}}),ne=Z;export{ne as S};
