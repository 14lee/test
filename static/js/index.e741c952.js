import{d as ce,b as oe,r as ue,w as Ve,i as he,c as ye,N as ge,n as be,aj as C,e as k,t as fe,o as a,f as m,v as de,g as c,j as d,k as o,u,x as g,B as V,F as q,y as X,z as re,ai as Y,l as W,ak as Se,U as Ue,ad as Ce,ae as Ee,p as Le,X as Re,S as qe}from"./element-plus.59ccb443.js";import{A as x}from"./datasourceManage.013f4c4a.js";import{q as L}from"./lodash.22f463b4.js";import{R as He,t as Ne,x as Fe,y as xe,z as je,A as Ge,v as Me}from"./login.a4e9287e.js";import{a6 as Qe,i as Ye,a7 as Je}from"./index-a95bb620.js";import{D as p,J as Ae,d as ze,S as We}from"./index.vue_vue_type_style_index_0_scoped_7b7c1886_lang.2666f209.js";import{_ as Xe}from"./error.229cea25.js";import"../../app-config.js";import"./echarts.39e3cf74.js";import"./wujie-vue3.9ecbe737.js";import"./smartweb3.2d5e4c59.js";import"./smart-ui.e8e0134c.js";var Z=(S=>(S.NONE="",S.POSTGIS="POSTGIS",S.MYSQL="MYSQL",S.RESTAPI="RESTAPI",S.NEBULAGRAPH="NEBULAGRAPH",S.KAFKA="KAFKA",S.MONGODB="MONGODB",S.ELASTICSEARCH="ELASTICSEARCH",S.HDFS="HDFS",S.KINGBASE="KINGBASE",S))(Z||{});const ae=[{code:"POSTGIS",name:"PostGIS"},{code:"MYSQL",name:"MySQL"},{code:"RESTAPI",name:"REST API"},{code:"NEBULAGRAPH",name:"Nebula Graph"},{code:"KAFKA",name:"Kafka"},{code:"MONGODB",name:"MongoDB"},{code:"ELASTICSEARCH",name:"ElasticSearch"},{code:"HDFS",name:"Hdfs"},{code:"KINGBASE",name:"KingbaseES"}];var me=(S=>(S.NO_AUTH="NO_AUTH",S.BEARER_TOKEN="BEARER_TOKEN",S.BASIC_AUTH="BASIC_AUTH",S.API_KEY="API_KEY",S))(me||{});const Ke=[{code:"NO_AUTH",name:"No Auth"},{code:"BEARER_TOKEN",name:"Bearer Token"},{code:"BASIC_AUTH",name:"Basic Auth"},{code:"API_KEY",name:"API Key"}];var ie=(S=>(S.HEADER="HEADER",S.QUERY="QUERY",S.BODY="BODY",S))(ie||{});const Ze=[{code:"HEADER",name:"Header"},{code:"QUERY",name:"Query"},{code:"BODY",name:"Body"}];var _e=(S=>(S.X_FORM="X_FORM",S.JSON="JSON",S))(_e||{});const et=[{code:"X_FORM",name:"application/x-www-form-urlencoded"},{code:"JSON",name:"application/json"}];function tt(S){const j="MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCDcAx2LywL0jxDoTaLrUqsLUCAV/D/bb3I+ZqN0WlcD00Vghr/DX2uiK9igRZsj489C3S6LeuEA+k80zz+Gaa4xY3QtQA3pkmOD7j69VP1jxhDHjip/2iY+WAu2j8cBSTX1lP4SQDevcWpIUV8yffE8cxd+GeQjaxlT8GzcCmWZwIDAQAB",N=new He;return N.setPublicKey(j),N.encrypt(S)}function at(S){const j="",N=new He;return N.setPrivateKey(j),N.decrypt(S)}const ke={rsaEncrypt:tt,rsaDecrypt:at},lt={class:"card"},st=c("div",{class:"subtitle"},"数据源信息",-1),ot={class:"content-wrap"},dt={class:"item-wrap item2"},it={key:1},nt={key:1},rt={class:"item-wrap item2"},ut={key:1},pt={key:1},mt={class:"item-wrap item2"},ct={key:1},yt={key:1},ft={class:"item-wrap item2"},gt={key:1},Dt={key:0},bt={class:"item-wrap"},_t={class:"item-wrap"},ht={class:"item-wrap"},vt={key:1},wt=ce({__name:"PostGisForm",props:{type:{default:p.CHECK},curEditId:{default:""},submiting:{type:Boolean,default:!1},checkingConnect:{type:Boolean,default:!1}},emits:["update:submiting","update:checkingConnect","changeType","save"],setup(S,{expose:j,emit:N}){const b=N,w=S,v=oe(),e=oe(),f=ue({isLoading:!1,initData:{id:"",name:"",type:Z.POSTGIS,address:"",port:"",dbname:"",schema:"",username:"",password:"",userIds:[],enable:!0,description:""},editData:{},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{min:0,max:50,message:"长度在 50 个字符以内",trigger:["blur","change"]}],type:[{required:!0,message:"数据源类型不能为空",trigger:"change"}],address:[{required:!0,message:"数据库地址不能为空",trigger:["blur","change"]}],port:[{required:!0,message:"端口不能为空",trigger:["blur","change"]}],dbname:[{required:!0,message:"数据库名不能为空",trigger:["blur","change"]}],schema:[{required:!0,message:"对象名不能为空",trigger:"change"}],username:[{required:!0,message:"用户名不能为空",trigger:["blur","change"]}],password:[{required:!0,message:"密码不能为空",trigger:["blur","change"]}]},schemaOptions:[{value:"public",label:"public"}],isLinkSuccess:!0,isEditPassword:!1});Ve(()=>f.isEditPassword,r=>{var n;r?f.editData.password="":w.type===p.EDIT&&(f.editData.password="xxxx"),(n=v.value)==null||n.clearValidate("password")});const G=he("getUserOptions"),O=ye(()=>G==null?void 0:G());ge(()=>{A()});function A(){f.isEditPassword=!1,f.schemaOptions=[{value:"public",label:"public"}],w.type===p.ADD?f.editData=L.cloneDeep(f.initData):i(w.curEditId),be(()=>{var r;(r=v.value)==null||r.clearValidate()})}function i(r){f.isLoading=!0,x.getDataSourceById(r).then(n=>{if(n.code==="0000"){f.editData=L.cloneDeep(f.initData);for(const _ in f.initData)f.editData[_]=n.data[_];f.editData.userIds?f.editData.userIds=f.editData.userIds.split(","):f.editData.userIds=[]}else C({type:"error",message:"获取信息失败"})}).catch(()=>{C({type:"error",message:"获取信息错误"})}).finally(()=>{f.isLoading=!1})}function Q(r){b("changeType",r)}function R(){t()}function M(r){return new Promise(n=>{r.validate(_=>{n(_)})})}function l(){M(v.value).then(n=>{if(n){const _=L.cloneDeep(f.editData);_.userIds=f.editData.userIds.join(",");const D=w.type===p.ADD;D||f.isEditPassword?_.password=ke.rsaEncrypt(_.password):delete _.password,b("update:submiting",!0),x[D?"addDataSource":"updateDataSource"](_).then(T=>{b("update:submiting",!1),T.code==="0000"?(Y({type:"success",title:`${D?"注册":"保存"}成功`}),b("save")):Y({type:"error",title:`${D?"注册":"保存"}失败`,message:T.message})}).catch(T=>{b("update:submiting",!1),Y({type:"error",title:`${D?"注册":"保存"}错误`,message:T.message})})}})}function t(r=!1){var z,ne,I;(z=v.value)==null||z.validateField(["type","address","port","dbname","username"]);const n=w.type===p.ADD;(f.isEditPassword||n)&&((ne=v.value)==null||ne.validateField(["password"]));const{id:_,type:D,address:K,port:T,dbname:F,username:s,password:h}=L.cloneDeep(f.editData);if((n||f.isEditPassword?!!h:!0)&&D&&K&&T&&F&&s){r&&b("update:checkingConnect",!0);const E={id:_,type:D,address:K,port:T,dbname:F,username:s};(f.isEditPassword||n)&&(E.password=ke.rsaEncrypt(h)),x.connectDataBaseTest(E).then(U=>{var B;b("update:checkingConnect",!1),U.code==="0000"?(U.data.success?(f.isLinkSuccess=!0,r&&C({type:"success",message:"数据源连接成功"})):(f.isLinkSuccess=!1,r&&C({type:"error",message:"数据源连接失败"})),r||(f.schemaOptions=(B=U.data.schemas)==null?void 0:B.map(ee=>({value:ee,lebel:ee})))):(f.isLinkSuccess=!1,r&&C({type:"error",message:"数据源连接失败"}))}).catch(()=>{f.isLinkSuccess=!1,b("update:checkingConnect",!1),r&&C({type:"error",message:"数据源连接失败"})})}else(I=e.value)==null||I.blur(),C({type:"warning",message:"请先填写相关信息"})}return j({handleCheckConnect:t,handleSaveForm:l}),(r,n)=>{const _=k("el-input"),D=k("el-form-item"),K=k("el-option"),T=k("el-select"),F=k("el-switch"),s=k("el-form"),h=fe("loading");return a(),m("div",lt,[de((a(),m("div",null,[st,c("div",ot,[d(s,{ref_key:"editForm",ref:v,class:"form edit-form",inline:"",model:f.editData,rules:f.rules,"label-width":"auto","label-position":"right"},{default:o(()=>[c("div",dt,[d(D,{label:"数据源名称",prop:"name"},{default:o(()=>[r.type!==u(p).CHECK?(a(),g(_,{key:0,modelValue:f.editData.name,"onUpdate:modelValue":n[0]||(n[0]=$=>f.editData.name=$),type:"text",placeholder:"请输入数据源名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",it,V(f.editData.name),1))]),_:1}),d(D,{key:"type",label:"数据源类型",prop:"type"},{default:o(()=>{var $;return[r.type===u(p).ADD?(a(),g(T,{key:0,modelValue:f.editData.type,"onUpdate:modelValue":n[1]||(n[1]=z=>f.editData.type=z),style:{width:"100%"},filterable:"",placeholder:"请选择数据源类型",onChange:Q},{default:o(()=>[(a(!0),m(q,null,X(u(ae),z=>(a(),g(K,{key:z.code,label:z.name,value:z.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(a(),m("span",nt,V((($=u(ae).find(z=>z.code===f.editData.type))==null?void 0:$.name)||"未知类型"),1))]}),_:1})]),c("div",rt,[d(D,{label:"数据库地址",prop:"address"},{default:o(()=>[r.type!==u(p).CHECK?(a(),g(_,{key:0,modelValue:f.editData.address,"onUpdate:modelValue":n[2]||(n[2]=$=>f.editData.address=$),type:"text",placeholder:"例如：127.0.0.1"},null,8,["modelValue"])):(a(),m("span",ut,V(f.editData.address),1))]),_:1}),d(D,{label:"端口",prop:"port"},{default:o(()=>[r.type!==u(p).CHECK?(a(),g(_,{key:0,modelValue:f.editData.port,"onUpdate:modelValue":n[3]||(n[3]=$=>f.editData.port=$),type:"text",placeholder:"请输入端口，例如 8888"},null,8,["modelValue"])):(a(),m("span",pt,V(f.editData.port),1))]),_:1})]),c("div",mt,[d(D,{label:"数据库名",prop:"dbname"},{default:o(()=>[r.type!==u(p).CHECK?(a(),g(_,{key:0,modelValue:f.editData.dbname,"onUpdate:modelValue":n[4]||(n[4]=$=>f.editData.dbname=$),type:"text",placeholder:"请输入数据库名"},null,8,["modelValue"])):(a(),m("span",ct,V(f.editData.dbname),1))]),_:1}),d(D,{key:"schema",label:"对象名",prop:"schema"},{default:o(()=>[r.type!==u(p).CHECK?(a(),g(T,{key:0,ref_key:"schemaSelect",ref:e,modelValue:f.editData.schema,"onUpdate:modelValue":n[5]||(n[5]=$=>f.editData.schema=$),"popper-class":f.isLinkSuccess?"success-select":"fail-select",style:{width:"100%"},filterable:"",placeholder:"请选择对象名",teleported:!1,onFocus:R},{default:o(()=>[(a(!0),m(q,null,X(f.schemaOptions,$=>(a(),g(K,{key:$.value,label:$.label,value:$.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","popper-class"])):(a(),m("span",yt,V(f.editData.schema),1))]),_:1})]),c("div",ft,[d(D,{key:"username",label:"用户名",prop:"username"},{default:o(()=>[r.type!==u(p).CHECK?(a(),g(_,{key:0,modelValue:f.editData.username,"onUpdate:modelValue":n[6]||(n[6]=$=>f.editData.username=$),type:"text",placeholder:"请输入用户名"},null,8,["modelValue"])):(a(),m("span",gt,V(f.editData.username),1))]),_:1}),d(D,{key:"password",class:"password",label:"密码",prop:"password"},{default:o(()=>[r.type===u(p).CHECK?(a(),m("span",Dt,"**********")):(a(),m(q,{key:1},[r.type===u(p).ADD?(a(),g(_,{key:0,modelValue:f.editData.password,"onUpdate:modelValue":n[7]||(n[7]=$=>f.editData.password=$),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])):(a(),m(q,{key:1},[f.isEditPassword?(a(),g(_,{key:0,modelValue:f.editData.password,"onUpdate:modelValue":n[8]||(n[8]=$=>f.editData.password=$),type:"password",style:{width:"80%","margin-right":"20px"},placeholder:"请输入密码","show-password":""},null,8,["modelValue"])):re("",!0),c("span",{class:"btn",onClick:n[9]||(n[9]=$=>f.isEditPassword=!f.isEditPassword)},V(f.isEditPassword?"取消":"修改"),1)],64))],64))]),_:1})]),c("div",bt,[d(D,{label:"数据源状态",prop:"enable"},{default:o(()=>[d(F,{modelValue:f.editData.enable,"onUpdate:modelValue":n[10]||(n[10]=$=>f.editData.enable=$),disabled:r.type===u(p).CHECK,class:"swith-btn","active-value":!0,"inactive-value":!1},null,8,["modelValue","disabled"])]),_:1})]),c("div",_t,[d(D,{key:"userIds",label:"权限配置",prop:"userIds"},{default:o(()=>[d(T,{modelValue:f.editData.userIds,"onUpdate:modelValue":n[11]||(n[11]=$=>f.editData.userIds=$),class:"member-select",disabled:r.type===u(p).CHECK,multiple:"",filterable:"",clearable:"",placeholder:"请选择",style:{width:"100%"}},{default:o(()=>[(a(!0),m(q,null,X(O.value,$=>(a(),g(K,{key:$.userId,label:$.userName,value:$.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),c("div",ht,[d(D,{label:"说明",prop:"description"},{default:o(()=>[r.type!==u(p).CHECK?(a(),g(_,{key:0,modelValue:f.editData.description,"onUpdate:modelValue":n[12]||(n[12]=$=>f.editData.description=$),type:"text",placeholder:"请输入说明",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",vt,V(f.editData.description),1))]),_:1})])]),_:1},8,["model","rules"])])])),[[h,f.isLoading]])])}}}),kt={class:"card"},Vt=c("div",{class:"subtitle"},"数据源信息",-1),Ct={class:"content-wrap"},Et={class:"item-wrap item2"},It={key:1},Tt={key:1},St={class:"item-wrap item2"},$t={key:1},At={key:1},Kt={class:"item-wrap item2"},Ut={key:1},Ht={class:"item-wrap item2"},Pt={key:1},Ot={key:0},Bt={class:"item-wrap"},Lt={class:"item-wrap"},Rt={class:"item-wrap"},qt={key:1},Nt=ce({__name:"MySqlForm",props:{type:{default:p.CHECK},curEditId:{default:""},submiting:{type:Boolean,default:!1},checkingConnect:{type:Boolean,default:!1}},emits:["update:submiting","update:checkingConnect","changeType","save"],setup(S,{expose:j,emit:N}){const b=N,w=S,v=oe(),e=ue({isLoading:!1,initData:{id:"",name:"",type:Z.MYSQL,address:"",port:"",dbname:"",username:"",password:"",userIds:[],enable:!0,description:""},editData:{},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{min:0,max:50,message:"长度在 50 个字符以内",trigger:["blur","change"]}],type:[{required:!0,message:"数据源类型不能为空",trigger:"change"}],address:[{required:!0,message:"数据库地址不能为空",trigger:["blur","change"]}],port:[{required:!0,message:"端口不能为空",trigger:["blur","change"]}],dbname:[{required:!0,message:"数据库名不能为空",trigger:["blur","change"]}],username:[{required:!0,message:"用户名不能为空",trigger:["blur","change"]}],password:[{required:!0,message:"密码不能为空",trigger:["blur","change"]}]},isLinkSuccess:!0,isEditPassword:!1});Ve(()=>e.isEditPassword,l=>{var t;l?e.editData.password="":w.type===p.EDIT&&(e.editData.password="xxxx"),(t=v.value)==null||t.clearValidate("password")});const f=he("getUserOptions"),G=ye(()=>f==null?void 0:f());ge(()=>{O()});function O(){e.isEditPassword=!1,w.type===p.ADD?e.editData=L.cloneDeep(e.initData):A(w.curEditId),be(()=>{var l;(l=v.value)==null||l.clearValidate()})}function A(l){e.isLoading=!0,x.getDataSourceById(l).then(t=>{if(t.code==="0000"){e.editData=L.cloneDeep(e.initData);for(const r in e.initData)e.editData[r]=t.data[r];e.editData.userIds?e.editData.userIds=e.editData.userIds.split(","):e.editData.userIds=[]}else C({type:"error",message:"获取信息失败"})}).catch(()=>{C({type:"error",message:"获取信息错误"})}).finally(()=>{e.isLoading=!1})}function i(l){b("changeType",l)}function Q(l){return new Promise(t=>{l.validate(r=>{t(r)})})}function R(){Q(v.value).then(t=>{if(t){const r=L.cloneDeep(e.editData);r.userIds=e.editData.userIds.join(",");const n=w.type===p.ADD;n||e.isEditPassword?r.password=ke.rsaEncrypt(r.password):delete r.password,b("update:submiting",!0),x[n?"addDataSource":"updateDataSource"](r).then(D=>{b("update:submiting",!1),D.code==="0000"?(Y({type:"success",title:`${n?"注册":"保存"}成功`}),b("save")):Y({type:"error",title:`${n?"注册":"保存"}失败`,message:D.message})}).catch(D=>{b("update:submiting",!1),Y({type:"error",title:`${n?"注册":"保存"}错误`,message:D.message})})}})}function M(l=!1){var h,$;(h=v.value)==null||h.validateField(["type","address","port","dbname","username"]);const t=w.type===p.ADD;(e.isEditPassword||t)&&(($=v.value)==null||$.validateField(["password"]));const{id:r,type:n,address:_,port:D,dbname:K,username:T,password:F}=L.cloneDeep(e.editData);if((t||e.isEditPassword?!!F:!0)&&n&&_&&D&&K&&T){l&&b("update:checkingConnect",!0);const z={id:r,type:n,address:_,port:D,dbname:K,username:T};(e.isEditPassword||t)&&(z.password=ke.rsaEncrypt(F)),x.connectDataBaseTest(z).then(ne=>{b("update:checkingConnect",!1),ne.code==="0000"?ne.data.success?(e.isLinkSuccess=!0,l&&C({type:"success",message:"数据源连接成功"})):(e.isLinkSuccess=!1,l&&C({type:"error",message:"数据源连接失败"})):(e.isLinkSuccess=!1,l&&C({type:"error",message:"数据源连接失败"}))}).catch(()=>{e.isLinkSuccess=!1,b("update:checkingConnect",!1),l&&C({type:"error",message:"数据源连接失败"})})}else C({type:"warning",message:"请先填写相关信息"})}return j({handleCheckConnect:M,handleSaveForm:R}),(l,t)=>{const r=k("el-input"),n=k("el-form-item"),_=k("el-option"),D=k("el-select"),K=k("el-switch"),T=k("el-form"),F=fe("loading");return a(),m("div",kt,[de((a(),m("div",null,[Vt,c("div",Ct,[d(T,{ref_key:"editForm",ref:v,class:"form edit-form",inline:"",model:e.editData,rules:e.rules,"label-width":"auto","label-position":"right"},{default:o(()=>[c("div",Et,[d(n,{label:"数据源名称",prop:"name"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.name,"onUpdate:modelValue":t[0]||(t[0]=s=>e.editData.name=s),type:"text",placeholder:"请输入数据源名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",It,V(e.editData.name),1))]),_:1}),d(n,{key:"type",label:"数据源类型",prop:"type"},{default:o(()=>{var s;return[l.type===u(p).ADD?(a(),g(D,{key:0,modelValue:e.editData.type,"onUpdate:modelValue":t[1]||(t[1]=h=>e.editData.type=h),style:{width:"100%"},filterable:"",placeholder:"请选择数据源类型",onChange:i},{default:o(()=>[(a(!0),m(q,null,X(u(ae),h=>(a(),g(_,{key:h.code,label:h.name,value:h.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(a(),m("span",Tt,V(((s=u(ae).find(h=>h.code===e.editData.type))==null?void 0:s.name)||"未知类型"),1))]}),_:1})]),c("div",St,[d(n,{label:"数据库地址",prop:"address"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.address,"onUpdate:modelValue":t[2]||(t[2]=s=>e.editData.address=s),type:"text",placeholder:"例如：127.0.0.1"},null,8,["modelValue"])):(a(),m("span",$t,V(e.editData.address),1))]),_:1}),d(n,{label:"端口",prop:"port"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.port,"onUpdate:modelValue":t[3]||(t[3]=s=>e.editData.port=s),type:"text",placeholder:"请输入端口，例如 8888"},null,8,["modelValue"])):(a(),m("span",At,V(e.editData.port),1))]),_:1})]),c("div",Kt,[d(n,{label:"数据库名",prop:"dbname"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.dbname,"onUpdate:modelValue":t[4]||(t[4]=s=>e.editData.dbname=s),type:"text",placeholder:"请输入数据库名"},null,8,["modelValue"])):(a(),m("span",Ut,V(e.editData.dbname),1))]),_:1}),d(n)]),c("div",Ht,[d(n,{key:"username",label:"用户名",prop:"username"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.username,"onUpdate:modelValue":t[5]||(t[5]=s=>e.editData.username=s),type:"text",placeholder:"请输入用户名"},null,8,["modelValue"])):(a(),m("span",Pt,V(e.editData.username),1))]),_:1}),d(n,{key:"password",class:"password",label:"密码",prop:"password"},{default:o(()=>[l.type===u(p).CHECK?(a(),m("span",Ot,"**********")):(a(),m(q,{key:1},[l.type===u(p).ADD?(a(),g(r,{key:0,modelValue:e.editData.password,"onUpdate:modelValue":t[6]||(t[6]=s=>e.editData.password=s),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])):(a(),m(q,{key:1},[e.isEditPassword?(a(),g(r,{key:0,modelValue:e.editData.password,"onUpdate:modelValue":t[7]||(t[7]=s=>e.editData.password=s),type:"password",style:{width:"80%","margin-right":"20px"},placeholder:"请输入密码","show-password":""},null,8,["modelValue"])):re("",!0),c("span",{class:"btn",onClick:t[8]||(t[8]=s=>e.isEditPassword=!e.isEditPassword)},V(e.isEditPassword?"取消":"修改"),1)],64))],64))]),_:1})]),c("div",Bt,[d(n,{label:"数据源状态",prop:"enable"},{default:o(()=>[d(K,{modelValue:e.editData.enable,"onUpdate:modelValue":t[9]||(t[9]=s=>e.editData.enable=s),disabled:l.type===u(p).CHECK,class:"swith-btn","active-value":!0,"inactive-value":!1},null,8,["modelValue","disabled"])]),_:1})]),c("div",Lt,[d(n,{key:"userIds",label:"权限配置",prop:"userIds"},{default:o(()=>[d(D,{modelValue:e.editData.userIds,"onUpdate:modelValue":t[10]||(t[10]=s=>e.editData.userIds=s),class:"member-select",disabled:l.type===u(p).CHECK,multiple:"",filterable:"",clearable:"",placeholder:"请选择",style:{width:"100%"}},{default:o(()=>[(a(!0),m(q,null,X(G.value,s=>(a(),g(_,{key:s.userId,label:s.userName,value:s.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),c("div",Rt,[d(n,{label:"说明",prop:"description"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.description,"onUpdate:modelValue":t[11]||(t[11]=s=>e.editData.description=s),type:"text",placeholder:"请输入说明",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",qt,V(e.editData.description),1))]),_:1})])]),_:1},8,["model","rules"])])])),[[F,e.isLoading]])])}}}),Ft={class:"main-editor-content"},xt={class:"dialog-footer"},jt=c("div",{class:"tips"},"说明：支持JSON格式",-1),Gt=ce({__name:"ParamsEditorDialog",props:{visible:{type:Boolean,default:!1},isImport:{type:Boolean,default:!0},jsonData:{default:()=>[]}},emits:["update:visible","save"],setup(S,{emit:j}){const N=j,b=S,w=oe(),v=ue({dialogVisible:!1,data:[]});Ve(()=>b.visible,O=>{v.dialogVisible=O});function e(){be(()=>{var O,A;(A=(O=w.value)==null?void 0:O.editor)==null||A.set(b.isImport?[]:b.jsonData)})}function f(){N("update:visible",!1)}async function G(){var A,i,Q,R,M,l;const O=await((i=(A=w.value)==null?void 0:A.editor)==null?void 0:i.validate());if((O==null?void 0:O.length)===0)if(((R=(Q=w.value)==null?void 0:Q.editor)==null?void 0:R.getText())==="")Se.alert("未填写任何参数","提示");else{const t=(l=(M=w.value)==null?void 0:M.editor)==null?void 0:l.get();b.isImport?Array.isArray(t)?(N("save",t),f()):Se.alert("参数需填写数组类型","提示"):(Qe(JSON.stringify(t)),f())}else Se.alert("请正确填写参数JSON","提示")}return(O,A)=>{const i=k("el-button"),Q=k("el-dialog");return a(),g(Q,{modelValue:v.dialogVisible,"onUpdate:modelValue":A[1]||(A[1]=R=>v.dialogVisible=R),class:"center-dialog params-editor-dialog","append-to-body":!1,"close-on-press-escape":!1,title:(O.isImport?"导入":"复制")+"参数",onOpen:e,onClosed:f},{footer:o(()=>[c("span",xt,[jt,d(i,{onClick:f},{default:o(()=>[W("取 消")]),_:1}),d(i,{type:"primary",onClick:G},{default:o(()=>[W(V(O.isImport?" 确 定 ":" 复 制 "),1)]),_:1})])]),default:o(()=>[c("div",Ft,[d(u(Ae),{ref_key:"editorRef",ref:w,modelValue:v.data,"onUpdate:modelValue":A[0]||(A[0]=R=>v.data=R),class:"editor",language:"zh-CN"},null,8,["modelValue"])])]),_:1},8,["modelValue","title"])}}});const Mt={class:"card"},Qt=c("div",{class:"subtitle"},"数据源信息",-1),Yt={class:"content-wrap"},Jt={class:"item-wrap item2"},zt={key:1},Wt={key:1},Xt={class:"item-wrap"},Zt={class:"item-wrap item2"},ea={key:1},ta={key:0,class:"item-wrap"},aa={key:1},la={key:1,class:"item-wrap item2"},sa={key:1},oa={key:0},da={key:2,class:"item-wrap"},ia=c("span",null,"--",-1),na={class:"item-wrap"},ra={class:"item-wrap"},ua={key:1},pa={class:"card"},ma={class:"subtitle tabs"},ca=["onClick"],ya={class:"content-wrap"},fa={key:0,class:"TableBtnsContainer"},ga=c("span",{class:"label"},"类型 ：",-1),Da={class:"content-wrap"},ba=c("p",null,[c("span",{style:{"font-size":"16px",color:"#ff8282"}},"*"),W(" 参数名 ")],-1),_a={key:1},ha=c("p",null,[c("span",{style:{"font-size":"16px",color:"#ff8282"}},"*"),W(" 参数值 ")],-1),va={key:1},wa={key:1},ka=["onClick"],Va={class:"content-wrap"},Ca=c("p",null,[c("span",{style:{"font-size":"16px",color:"#ff8282"}},"*"),W(" 参数名 ")],-1),Ea={key:1},Ia=c("p",null,[c("span",{style:{"font-size":"16px",color:"#ff8282"}},"*"),W(" 参数值 ")],-1),Ta={key:1},Sa={key:1},$a=["onClick"],Aa={class:"content-wrap"},Ka=c("p",null,[c("span",{style:{"font-size":"16px",color:"#ff8282"}},"*"),W(" 参数名 ")],-1),Ua={key:1},Ha=c("p",null,[c("span",{style:{"font-size":"16px",color:"#ff8282"}},"*"),W(" 参数值 ")],-1),Pa={key:1},Oa={key:1},Ba=["onClick"],La={class:"editor-content"},Ra={key:1,class:"content-wrap"},qa=c("div",{id:"anchorPoint",style:{overflow:"hidden"}},null,-1),Na=ce({__name:"RestApiForm",props:{type:{default:p.CHECK},curEditId:{default:""},submiting:{type:Boolean,default:!1},checkingConnect:{type:Boolean,default:!1}},emits:["update:submiting","update:checkingConnect","changeType","save"],setup(S,{expose:j,emit:N}){const b=N,w=S,v=oe(),e=oe(),f=oe(),G=oe(),O=oe(),A=oe(),i=ue({isLoading:!1,initData:{id:"",name:"",type:Z.RESTAPI,address:"",username:"",password:"",userIds:[],enable:!0,description:"",queryType:"GET",authType:me.NO_AUTH,token:"",apiKeyQueryType:"HEADER",apiKeyAuthParamsObj:{key:"",value:""}},editData:{},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{min:0,max:50,message:"长度在 50 个字符以内",trigger:["blur","change"]}],type:[{required:!0,message:"数据源类型不能为空",trigger:"change"}],address:[{required:!0,message:"请求地址不能为空",trigger:["blur"]}],username:[{required:!0,message:"用户名不能为空",trigger:["blur","change"]}],password:[{required:!0,message:"密码不能为空",trigger:["blur","change"]}],authType:[{required:!0,message:"认证方式不能为空",trigger:["change"]}],token:[{required:!0,message:"token不能为空",trigger:["blur","change"]}],apiKeyAuthParamsObj:{type:"object",required:!0,fields:{key:{type:"string",required:!0,message:"key值不能为空",trigger:["blur","change"]},value:{type:"string",required:!0,message:"value值不能为空",trigger:["blur","change"]}}}},isLinkSuccess:!0,curTabName:ie.HEADER,headerTableData:[],queryTableData:[],bodyTableData:[],bodyJsonData:[],bodyContentType:_e.X_FORM,tableRules:{key:[{required:!0,message:"参数名不能为空",trigger:["blur","change"]}],value:[{required:!0,message:"参数值不能为空",trigger:["blur","change"]}]},editorDialogVisible:!1,isImportEditor:!0,copyJsonData:[]}),Q=he("getUserOptions"),R=ye(()=>Q==null?void 0:Q()),M=ye(()=>i.editData.authType===me.NO_AUTH?{authType:me.NO_AUTH}:i.editData.authType===me.BEARER_TOKEN?{authType:me.BEARER_TOKEN,token:i.editData.token}:i.editData.authType===me.BASIC_AUTH?{authType:me.BASIC_AUTH,username:i.editData.username,password:i.editData.password}:i.editData.authType===me.API_KEY?{authType:me.API_KEY,apiKeyQueryType:i.editData.apiKeyQueryType,apiKeyAuthParams:{[i.editData.apiKeyAuthParamsObj.key]:i.editData.apiKeyAuthParamsObj.value}}:{}),l=ye(()=>i.curTabName===ie.HEADER?"headerTableData":i.curTabName===ie.QUERY?"queryTableData":i.curTabName===ie.BODY?"bodyTableData":"headerTableData");ge(()=>{t()});function t(){w.type===p.ADD?i.editData=L.cloneDeep(i.initData):r(w.curEditId),be(()=>{var I;(I=e.value)==null||I.clearValidate()})}function r(I){i.isLoading=!0,x.getDataSourceById(I).then(E=>{var U,B,ee,le,J,te,pe,se;if(E.code==="0000"){i.editData=L.cloneDeep(i.initData);for(const P in i.initData)i.editData[P]=E.data[P];if(i.editData.userIds?i.editData.userIds=i.editData.userIds.split(","):i.editData.userIds=[],Ye((U=E.data)==null?void 0:U.config)){const P=JSON.parse(E.data.config);if(i.editData.queryType=(P==null?void 0:P.queryType)||i.initData.queryType,i.editData.authType=((B=P==null?void 0:P.authParam)==null?void 0:B.authType)||i.initData.authType,i.editData.token=((ee=P==null?void 0:P.authParam)==null?void 0:ee.token)||i.initData.token,i.editData.username=((le=P==null?void 0:P.authParam)==null?void 0:le.username)||i.initData.username,i.editData.password=((J=P==null?void 0:P.authParam)==null?void 0:J.password)||i.initData.password,i.editData.apiKeyQueryType=((te=P==null?void 0:P.authParam)==null?void 0:te.apiKeyQueryType)||i.initData.apiKeyQueryType,(pe=P==null?void 0:P.authParam)!=null&&pe.apiKeyAuthParams?i.editData.apiKeyAuthParamsObj={key:Object.keys(P.authParam.apiKeyAuthParams)[0]||"",value:Object.values(P.authParam.apiKeyAuthParams)[0]||""}:i.editData.apiKeyAuthParamsObj={key:"",value:""},((se=P==null?void 0:P.requestInfos)==null?void 0:se.length)>0){const ve=P.requestInfos.find(y=>y.paramType===ie.HEADER);ve&&(i.headerTableData=ve.params);const we=P.requestInfos.find(y=>y.paramType===ie.QUERY);we&&(i.queryTableData=we.params);const De=P.requestInfos.find(y=>y.paramType===ie.BODY);De&&(i.bodyTableData=De.params,i.bodyContentType=De.contentType,i.bodyJsonData=De.body)}}}else C({type:"error",message:"获取信息失败"})}).catch(()=>{C({type:"error",message:"获取信息错误"})}).finally(()=>{i.isLoading=!1})}function n(I){b("changeType",I)}function _(I){return new Promise(E=>{I.validate(U=>{E(U)})})}function D(){return new Promise(I=>{var E,U;(U=(E=A.value)==null?void 0:E.editor)==null||U.validate().then(B=>{(B==null?void 0:B.length)===0?I(!0):(C.error("请正确填写Body JSON参数"),I(!1))})})}function K(){const I=_(e.value),E=_(f.value),U=_(G.value),B=i.bodyContentType===_e.X_FORM?_(O.value):D();Promise.all([I,E,U,B]).then(([le,J,te,pe])=>{if(le&&J&&te&&pe){const{id:se,name:P,type:ve,queryType:we,address:De,description:y,userIds:H,enable:$e}=i.editData,Ie=T(),Pe={authParam:L.cloneDeep(M.value),queryType:we,requestInfos:Ie},Oe={id:se,name:P,type:ve,address:De,enable:$e,description:y,userIds:H.join(","),config:JSON.stringify(Pe)};b("update:submiting",!0);const Be=w.type===p.ADD?"addDataSource":"updateDataSource";x[Be](Oe).then(Te=>{b("update:submiting",!1),Te.code==="0000"?(Y({type:"success",title:`${w.type===p.ADD?"注册":"保存"}成功`}),b("save")):Y({type:"error",title:`${w.type===p.ADD?"注册":"保存"}失败`,message:Te.message})}).catch(Te=>{b("update:submiting",!1),Y({type:"error",title:`${w.type===p.ADD?"注册":"保存"}错误`,message:Te.message})})}})}function T(){var E,U,B,ee;const I=[];if(I.push({paramType:ie.HEADER,params:i.headerTableData}),I.push({paramType:ie.QUERY,params:i.queryTableData}),i.bodyContentType===_e.X_FORM)I.push({paramType:ie.BODY,params:i.bodyTableData,contentType:i.bodyContentType,body:[]});else{let le=[];((U=(E=A.value)==null?void 0:E.editor)==null?void 0:U.getText())===""?le=[]:le=(ee=(B=A.value)==null?void 0:B.editor)==null?void 0:ee.get(),I.push({paramType:ie.BODY,params:[],contentType:i.bodyContentType,body:le})}return I}function F(I=!1){const E=_(e.value),U=_(f.value),B=_(G.value),ee=i.bodyContentType===_e.X_FORM?_(O.value):D();Promise.all([E,U,B,ee]).then(([J,te,pe,se])=>{if(J&&te&&pe&&se){I&&b("update:checkingConnect",!0);const{id:P,type:ve,address:we,queryType:De}=L.cloneDeep(i.editData),y=T(),H={authParam:L.cloneDeep(M.value),queryType:De,requestInfos:y},$e={id:P,type:ve,address:we,config:JSON.stringify(H)};x.connectDataBaseTest($e).then(Ie=>{b("update:checkingConnect",!1),Ie.code==="0000"?Ie.data.success?(i.isLinkSuccess=!0,I&&C({type:"success",message:"数据源连接成功"})):(i.isLinkSuccess=!1,I&&C({type:"error",message:"数据源连接失败"})):(i.isLinkSuccess=!1,I&&C({type:"error",message:"数据源连接失败"}))}).catch(()=>{i.isLinkSuccess=!1,b("update:checkingConnect",!1),I&&C({type:"error",message:"数据源连接失败"})})}else C({type:"warning",message:"请先填写相关信息"})})}function s(I){i[l.value]=i[l.value].filter((E,U)=>U!==I)}function h(){const I={key:"",value:"",description:""};i[l.value].push(I),setTimeout(()=>{v.value.querySelector("#anchorPoint").scrollIntoView()},20)}function $(){}function z(I=!1){i.isImportEditor=I,i.editorDialogVisible=!0,i.copyJsonData=L.cloneDeep(i[l.value])}function ne(I){const E=L.cloneDeep(I).map(U=>({key:U.key||"",value:U.value||"",description:U.description||""}));i[l.value]=E}return j({handleCheckConnect:F,handleSaveForm:K}),(I,E)=>{const U=k("el-input"),B=k("el-form-item"),ee=k("el-option"),le=k("el-select"),J=k("el-switch"),te=k("el-form"),pe=k("el-button"),se=k("el-table-column"),P=k("el-table"),ve=k("Plus"),we=k("el-icon"),De=fe("loading");return de((a(),m("div",{ref_key:"mainRef",ref:v},[c("div",Mt,[Qt,c("div",Yt,[d(te,{ref_key:"editForm",ref:e,class:"form edit-form",inline:"",model:i.editData,rules:i.rules,"label-width":"auto","label-position":"right"},{default:o(()=>[c("div",Jt,[d(B,{label:"数据源名称",prop:"name"},{default:o(()=>[I.type!==u(p).CHECK?(a(),g(U,{key:0,modelValue:i.editData.name,"onUpdate:modelValue":E[0]||(E[0]=y=>i.editData.name=y),type:"text",placeholder:"请输入数据源名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",zt,V(i.editData.name),1))]),_:1}),d(B,{key:"type",label:"数据源类型",prop:"type"},{default:o(()=>{var y;return[I.type===u(p).ADD?(a(),g(le,{key:0,modelValue:i.editData.type,"onUpdate:modelValue":E[1]||(E[1]=H=>i.editData.type=H),style:{width:"100%"},filterable:"",placeholder:"请选择数据源类型",onChange:n},{default:o(()=>[(a(!0),m(q,null,X(u(ae),H=>(a(),g(ee,{key:H.code,label:H.name,value:H.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(a(),m("span",Wt,V(((y=u(ae).find(H=>H.code===i.editData.type))==null?void 0:y.name)||"未知类型"),1))]}),_:1})]),c("div",Xt,[d(B,{label:"请求地址",prop:"address"},{default:o(()=>[d(U,{modelValue:i.editData.address,"onUpdate:modelValue":E[3]||(E[3]=y=>i.editData.address=y),placeholder:"请输入接口请求地址 （http(s)://）",class:"input-with-select",disabled:I.type===u(p).CHECK},{prepend:o(()=>[d(le,{modelValue:i.editData.queryType,"onUpdate:modelValue":E[2]||(E[2]=y=>i.editData.queryType=y),placeholder:"请选择",style:{width:"85px"},disabled:I.type===u(p).CHECK},{default:o(()=>[d(ee,{label:"GET",value:"GET"}),d(ee,{label:"POST",value:"POST"})]),_:1},8,["modelValue","disabled"])]),_:1},8,["modelValue","disabled"])]),_:1})]),c("div",Zt,[d(B,{key:"authType",label:"认证方式",prop:"authType"},{default:o(()=>{var y;return[I.type!==u(p).CHECK?(a(),g(le,{key:0,modelValue:i.editData.authType,"onUpdate:modelValue":E[4]||(E[4]=H=>i.editData.authType=H),style:{width:"100%"},filterable:"",placeholder:"请选择"},{default:o(()=>[(a(!0),m(q,null,X(u(Ke),H=>(a(),g(ee,{key:H.code,label:H.name,value:H.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(a(),m("span",ea,V(((y=u(Ke).find(H=>H.code===i.editData.authType))==null?void 0:y.name)||"未知类型"),1))]}),_:1}),d(B,{label:"数据源状态",prop:"enable"},{default:o(()=>[d(J,{modelValue:i.editData.enable,"onUpdate:modelValue":E[5]||(E[5]=y=>i.editData.enable=y),disabled:I.type===u(p).CHECK,class:"swith-btn","active-value":!0,"inactive-value":!1},null,8,["modelValue","disabled"])]),_:1})]),i.editData.authType===u(me).BEARER_TOKEN?(a(),m("div",ta,[d(B,{label:"token",prop:"token"},{default:o(()=>[I.type!==u(p).CHECK?(a(),g(U,{key:0,modelValue:i.editData.token,"onUpdate:modelValue":E[6]||(E[6]=y=>i.editData.token=y),type:"text",placeholder:"请输入token"},null,8,["modelValue"])):(a(),m("span",aa,V(i.editData.token),1))]),_:1})])):re("",!0),i.editData.authType===u(me).BASIC_AUTH?(a(),m("div",la,[d(B,{key:"username",label:"用户名",prop:"username"},{default:o(()=>[I.type!==u(p).CHECK?(a(),g(U,{key:0,modelValue:i.editData.username,"onUpdate:modelValue":E[7]||(E[7]=y=>i.editData.username=y),type:"text",placeholder:"请输入用户名"},null,8,["modelValue"])):(a(),m("span",sa,V(i.editData.username),1))]),_:1}),d(B,{key:"password",class:"password",label:"密码",prop:"password"},{default:o(()=>[I.type===u(p).CHECK?(a(),m("span",oa,"**********")):(a(),g(U,{key:1,modelValue:i.editData.password,"onUpdate:modelValue":E[8]||(E[8]=y=>i.editData.password=y),type:"password",autocomplete:"new-password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"]))]),_:1})])):re("",!0),i.editData.authType===u(me).API_KEY?(a(),m("div",da,[d(B,{class:"apiKeyAuthParamsObj",label:"Key Value：",prop:"apiKeyAuthParamsObj"},{default:o(()=>[d(le,{modelValue:i.editData.apiKeyQueryType,"onUpdate:modelValue":E[9]||(E[9]=y=>i.editData.apiKeyQueryType=y),style:{width:"100px"},filterable:"",disabled:I.type===u(p).CHECK,placeholder:"请选择"},{default:o(()=>[d(ee,{label:"Header",value:"HEADER"}),d(ee,{label:"Query",value:"QUERY"})]),_:1},8,["modelValue","disabled"]),d(U,{modelValue:i.editData.apiKeyAuthParamsObj.key,"onUpdate:modelValue":E[10]||(E[10]=y=>i.editData.apiKeyAuthParamsObj.key=y),type:"text",style:{flex:"1","margin-inline":"12px"},disabled:I.type===u(p).CHECK,placeholder:"请输入key"},null,8,["modelValue","disabled"]),ia,d(U,{modelValue:i.editData.apiKeyAuthParamsObj.value,"onUpdate:modelValue":E[11]||(E[11]=y=>i.editData.apiKeyAuthParamsObj.value=y),type:"text",style:{flex:"1","margin-left":"12px"},disabled:I.type===u(p).CHECK,placeholder:"请输入value"},null,8,["modelValue","disabled"])]),_:1})])):re("",!0),c("div",na,[d(B,{key:"userIds",label:"权限配置",prop:"userIds"},{default:o(()=>[d(le,{modelValue:i.editData.userIds,"onUpdate:modelValue":E[12]||(E[12]=y=>i.editData.userIds=y),class:"member-select",disabled:I.type===u(p).CHECK,multiple:"",filterable:"",clearable:"",placeholder:"请选择",style:{width:"100%"}},{default:o(()=>[(a(!0),m(q,null,X(R.value,y=>(a(),g(ee,{key:y.userId,label:y.userName,value:y.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),c("div",ra,[d(B,{label:"说明",prop:"description"},{default:o(()=>[I.type!==u(p).CHECK?(a(),g(U,{key:0,modelValue:i.editData.description,"onUpdate:modelValue":E[13]||(E[13]=y=>i.editData.description=y),type:"text",placeholder:"请输入说明",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",ua,V(i.editData.description),1))]),_:1})])]),_:1},8,["model","rules"])])]),c("div",pa,[c("div",ma,[(a(!0),m(q,null,X(u(Ze),y=>(a(),m("span",{key:y.code,class:Ue(["tabsName",i.curTabName===y.code?"active":""]),onClick:H=>i.curTabName=y.code},V(y.name),11,ca))),128))]),c("div",ya,[I.type!==u(p).CHECK?(a(),m("div",fa,[i.curTabName===u(ie).BODY?(a(),m(q,{key:0},[ga,d(le,{modelValue:i.bodyContentType,"onUpdate:modelValue":E[14]||(E[14]=y=>i.bodyContentType=y),style:{width:"300px","margin-right":"12px"},filterable:"",placeholder:"请选择"},{default:o(()=>[(a(!0),m(q,null,X(u(et),y=>(a(),g(ee,{key:y.code,label:y.name,value:y.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),i.bodyContentType!==u(_e).JSON?(a(),m(q,{key:0},[d(pe,{type:"primary",plain:"",onClick:E[15]||(E[15]=y=>z(!0))},{default:o(()=>[W(" 导入参数 ")]),_:1}),d(pe,{type:"primary",plain:"",onClick:E[16]||(E[16]=y=>z())},{default:o(()=>[W(" 复制参数 ")]),_:1})],64)):re("",!0)],64)):(a(),m(q,{key:1},[d(pe,{type:"primary",plain:"",onClick:E[17]||(E[17]=y=>z(!0))},{default:o(()=>[W(" 导入参数 ")]),_:1}),d(pe,{type:"primary",plain:"",onClick:E[18]||(E[18]=y=>z())},{default:o(()=>[W(" 复制参数 ")]),_:1})],64))])):re("",!0)]),de(c("div",Da,[d(te,{ref_key:"headerTableFormRef",ref:f,class:"table-form edit-form",model:i},{default:o(()=>[d(P,{ref:"headerTableRef",class:"headerTable commonTable",data:i.headerTableData},{default:o(()=>[d(se,{prop:"key","min-width":"120"},{header:o(()=>[ba]),default:o(y=>[I.type!==u(p).CHECK?(a(),g(B,{key:0,prop:"headerTableData."+y.$index+".key",rules:i.tableRules.key},{default:o(()=>[d(U,{modelValue:y.row.key,"onUpdate:modelValue":H=>y.row.key=H,modelModifiers:{trim:!0},placeholder:"请输入参数名",onBlur:$},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])):(a(),m("span",_a,V(y.row.key),1))]),_:1}),d(se,{prop:"value","min-width":"120"},{header:o(()=>[ha]),default:o(y=>[I.type!==u(p).CHECK?(a(),g(B,{key:0,prop:"headerTableData."+y.$index+".value",rules:i.tableRules.value},{default:o(()=>[d(U,{modelValue:y.row.value,"onUpdate:modelValue":H=>y.row.value=H,placeholder:"请输入参数值",onBlur:$},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])):(a(),m("span",va,V(y.row.value),1))]),_:1}),d(se,{prop:"description",label:"参数描述","min-width":"120"},{default:o(y=>[I.type!==u(p).CHECK?(a(),g(B,{key:0,prop:"headerTableData."+y.$index+".description"},{default:o(()=>[d(U,{modelValue:y.row.description,"onUpdate:modelValue":H=>y.row.description=H,placeholder:"请输入参数描述"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])):(a(),m("span",wa,V(y.row.description),1))]),_:1}),I.type!==u(p).CHECK?(a(),g(se,{key:0,width:"100px",label:"操作",fixed:"right","class-name":"tableOperate"},{default:o(y=>[c("span",{class:"delete",onClick:Ce(H=>s(y.$index),["stop"])}," 删除 ",8,ka)]),_:1})):re("",!0)]),_:1},8,["data"])]),_:1},8,["model"])],512),[[Ee,i.curTabName===u(ie).HEADER]]),de(c("div",Va,[d(te,{ref_key:"queryTableFormRef",ref:G,class:"table-form edit-form",model:i},{default:o(()=>[d(P,{ref:"queryTableRef",class:"queryTable commonTable",data:i.queryTableData},{default:o(()=>[d(se,{prop:"key","min-width":"120"},{header:o(()=>[Ca]),default:o(y=>[I.type!==u(p).CHECK?(a(),g(B,{key:0,prop:"queryTableData."+y.$index+".key",rules:i.tableRules.key},{default:o(()=>[d(U,{modelValue:y.row.key,"onUpdate:modelValue":H=>y.row.key=H,modelModifiers:{trim:!0},placeholder:"请输入参数名",onBlur:$},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])):(a(),m("span",Ea,V(y.row.key),1))]),_:1}),d(se,{prop:"value","min-width":"120"},{header:o(()=>[Ia]),default:o(y=>[I.type!==u(p).CHECK?(a(),g(B,{key:0,prop:"queryTableData."+y.$index+".value",rules:i.tableRules.value},{default:o(()=>[d(U,{modelValue:y.row.value,"onUpdate:modelValue":H=>y.row.value=H,placeholder:"请输入参数值",onBlur:$},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])):(a(),m("span",Ta,V(y.row.value),1))]),_:1}),d(se,{prop:"description",label:"参数描述","min-width":"120"},{default:o(y=>[I.type!==u(p).CHECK?(a(),g(B,{key:0,prop:"queryTableData."+y.$index+".description"},{default:o(()=>[d(U,{modelValue:y.row.description,"onUpdate:modelValue":H=>y.row.description=H,placeholder:"请输入参数描述"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])):(a(),m("span",Sa,V(y.row.description),1))]),_:1}),I.type!==u(p).CHECK?(a(),g(se,{key:0,width:"100px",label:"操作",fixed:"right","class-name":"tableOperate"},{default:o(y=>[c("span",{class:"delete",onClick:Ce(H=>s(y.$index),["stop"])}," 删除 ",8,$a)]),_:1})):re("",!0)]),_:1},8,["data"])]),_:1},8,["model"])],512),[[Ee,i.curTabName===u(ie).QUERY]]),de(c("div",Aa,[de(d(te,{ref_key:"bodyTableFormRef",ref:O,class:"table-form edit-form",model:i},{default:o(()=>[d(P,{ref:"bodyTableRef",class:"bodyTable commonTable",data:i.bodyTableData},{default:o(()=>[d(se,{prop:"key","min-width":"120"},{header:o(()=>[Ka]),default:o(y=>[I.type!==u(p).CHECK?(a(),g(B,{key:0,prop:"bodyTableData."+y.$index+".key",rules:i.tableRules.key},{default:o(()=>[d(U,{modelValue:y.row.key,"onUpdate:modelValue":H=>y.row.key=H,modelModifiers:{trim:!0},placeholder:"请输入参数名",onBlur:$},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])):(a(),m("span",Ua,V(y.row.key),1))]),_:1}),d(se,{prop:"value","min-width":"120"},{header:o(()=>[Ha]),default:o(y=>[I.type!==u(p).CHECK?(a(),g(B,{key:0,prop:"bodyTableData."+y.$index+".value",rules:i.tableRules.value},{default:o(()=>[d(U,{modelValue:y.row.value,"onUpdate:modelValue":H=>y.row.value=H,placeholder:"请输入参数值",onBlur:$},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])):(a(),m("span",Pa,V(y.row.value),1))]),_:1}),d(se,{prop:"description",label:"参数描述","min-width":"120"},{default:o(y=>[I.type!==u(p).CHECK?(a(),g(B,{key:0,prop:"bodyTableData."+y.$index+".description"},{default:o(()=>[d(U,{modelValue:y.row.description,"onUpdate:modelValue":H=>y.row.description=H,placeholder:"请输入参数描述"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])):(a(),m("span",Oa,V(y.row.description),1))]),_:1}),I.type!==u(p).CHECK?(a(),g(se,{key:0,width:"100px",label:"操作",fixed:"right","class-name":"tableOperate"},{default:o(y=>[c("span",{class:"delete",onClick:Ce(H=>s(y.$index),["stop"])}," 删除 ",8,Ba)]),_:1})):re("",!0)]),_:1},8,["data"])]),_:1},8,["model"]),[[Ee,i.bodyContentType===u(_e).X_FORM]]),de(c("div",La,[I.type===u(p).CHECK?(a(),g(u(Ae),{key:0,modelValue:i.bodyJsonData,"onUpdate:modelValue":E[19]||(E[19]=y=>i.bodyJsonData=y),options:{onEditable:()=>!1},class:"editor",language:"zh-CN"},null,8,["modelValue"])):(a(),g(u(Ae),{key:1,ref_key:"editorRef",ref:A,modelValue:i.bodyJsonData,"onUpdate:modelValue":E[20]||(E[20]=y=>i.bodyJsonData=y),class:"editor",language:"zh-CN"},null,8,["modelValue"]))],512),[[Ee,i.bodyContentType===u(_e).JSON]])],512),[[Ee,i.curTabName===u(ie).BODY]]),i.curTabName===u(ie).BODY&&i.bodyContentType===u(_e).JSON?(a(),m(q,{key:0},[],64)):(a(),m("div",Ra,[I.type!==u(p).CHECK?(a(),m("div",{key:0,class:"addTableBtn",onClick:h},[d(we,null,{default:o(()=>[d(ve)]),_:1}),W("新增参数 ")])):re("",!0)])),qa,d(Gt,{visible:i.editorDialogVisible,"onUpdate:visible":E[21]||(E[21]=y=>i.editorDialogVisible=y),"is-import":i.isImportEditor,"json-data":i.copyJsonData,onSave:ne},null,8,["visible","is-import","json-data"])])])),[[De,i.isLoading]])}}});const Fa={class:"card"},xa=c("div",{class:"subtitle"},"数据源信息",-1),ja={class:"content-wrap"},Ga={class:"item-wrap item2"},Ma={key:1},Qa={key:1},Ya={class:"item-wrap item2"},Ja={key:1},za={key:1},Wa={class:"item-wrap item2"},Xa={key:1},Za={key:0},el={class:"item-wrap"},tl={class:"item-wrap"},al={class:"item-wrap"},ll={key:1},sl=ce({__name:"GraphForm",props:{type:{default:p.CHECK},curEditId:{default:""},submiting:{type:Boolean,default:!1},checkingConnect:{type:Boolean,default:!1}},emits:["update:submiting","update:checkingConnect","changeType","save"],setup(S,{expose:j,emit:N}){const b=N,w=S,v=oe(),e=ue({isLoading:!1,initData:{id:"",name:"",type:Z.NEBULAGRAPH,address:"",port:"",username:"",password:"",userIds:[],enable:!0,description:""},editData:{},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{min:0,max:50,message:"长度在 50 个字符以内",trigger:["blur","change"]}],type:[{required:!0,message:"数据源类型不能为空",trigger:"change"}],address:[{required:!0,message:"数据库地址不能为空",trigger:["blur","change"]}],port:[{required:!0,message:"端口不能为空",trigger:["blur","change"]}],username:[{required:!0,message:"用户名不能为空",trigger:["blur","change"]}],password:[{required:!0,message:"密码不能为空",trigger:["blur","change"]}]},isEditPassword:!1});Ve(()=>e.isEditPassword,l=>{var t;l?e.editData.password="":w.type===p.EDIT&&(e.editData.password="xxxx"),(t=v.value)==null||t.clearValidate("password")});const f=he("getUserOptions"),G=ye(()=>f==null?void 0:f());ge(()=>{O()});function O(){e.isEditPassword=!1,w.type===p.ADD?e.editData=L.cloneDeep(e.initData):A(w.curEditId),be(()=>{var l;(l=v.value)==null||l.clearValidate()})}function A(l){e.isLoading=!0,x.getDataSourceById(l).then(t=>{if(t.code==="0000"){e.editData=L.cloneDeep(e.initData);for(const r in e.initData)e.editData[r]=t.data[r];e.editData.userIds?e.editData.userIds=e.editData.userIds.split(","):e.editData.userIds=[]}else C({type:"error",message:"获取信息失败"})}).catch(()=>{C({type:"error",message:"获取信息错误"})}).finally(()=>{e.isLoading=!1})}function i(l){b("changeType",l)}function Q(l){return new Promise(t=>{l.validate(r=>{t(r)})})}function R(){Q(v.value).then(t=>{if(t){const r=L.cloneDeep(e.editData);r.userIds=e.editData.userIds.join(",");const n=w.type===p.ADD;n||e.isEditPassword?r.password=ke.rsaEncrypt(r.password):delete r.password,b("update:submiting",!0),x[n?"addDataSource":"updateDataSource"](r).then(D=>{b("update:submiting",!1),D.code==="0000"?(Y({type:"success",title:`${n?"注册":"保存"}成功`}),b("save")):Y({type:"error",title:`${n?"注册":"保存"}失败`,message:D.message})}).catch(D=>{b("update:submiting",!1),Y({type:"error",title:`${n?"注册":"保存"}错误`,message:D.message})})}})}function M(l=!1){var s,h;(s=v.value)==null||s.validateField(["type","address","port","username"]);const t=w.type===p.ADD;(e.isEditPassword||t)&&((h=v.value)==null||h.validateField(["password"]));const{id:r,type:n,address:_,port:D,username:K,password:T}=L.cloneDeep(e.editData);if((t||e.isEditPassword?!!T:!0)&&n&&_&&D&&K){l&&b("update:checkingConnect",!0);const $={id:r,type:n,address:_,port:D,username:K};(e.isEditPassword||t)&&($.password=ke.rsaEncrypt(T)),x.connectDataBaseTest($).then(z=>{b("update:checkingConnect",!1),z.code==="0000"?z.data.success?l&&C({type:"success",message:"数据源连接成功"}):l&&C({type:"error",message:"数据源连接失败"}):l&&C({type:"error",message:"数据源连接失败"})}).catch(()=>{b("update:checkingConnect",!1),l&&C({type:"error",message:"数据源连接失败"})})}else C({type:"warning",message:"请先填写相关信息"})}return j({handleCheckConnect:M,handleSaveForm:R}),(l,t)=>{const r=k("el-input"),n=k("el-form-item"),_=k("el-option"),D=k("el-select"),K=k("el-switch"),T=k("el-form"),F=fe("loading");return a(),m("div",Fa,[de((a(),m("div",null,[xa,c("div",ja,[d(T,{ref_key:"editForm",ref:v,class:"form edit-form",inline:"",model:e.editData,rules:e.rules,"label-width":"auto","label-position":"right"},{default:o(()=>[c("div",Ga,[d(n,{label:"数据源名称",prop:"name"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.name,"onUpdate:modelValue":t[0]||(t[0]=s=>e.editData.name=s),type:"text",placeholder:"请输入数据源名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",Ma,V(e.editData.name),1))]),_:1}),d(n,{key:"type",label:"数据源类型",prop:"type"},{default:o(()=>{var s;return[l.type===u(p).ADD?(a(),g(D,{key:0,modelValue:e.editData.type,"onUpdate:modelValue":t[1]||(t[1]=h=>e.editData.type=h),style:{width:"100%"},filterable:"",placeholder:"请选择数据源类型",onChange:i},{default:o(()=>[(a(!0),m(q,null,X(u(ae),h=>(a(),g(_,{key:h.code,label:h.name,value:h.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(a(),m("span",Qa,V(((s=u(ae).find(h=>h.code===e.editData.type))==null?void 0:s.name)||"未知类型"),1))]}),_:1})]),c("div",Ya,[d(n,{label:"数据库地址",prop:"address"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.address,"onUpdate:modelValue":t[2]||(t[2]=s=>e.editData.address=s),type:"text",placeholder:"例如：127.0.0.1"},null,8,["modelValue"])):(a(),m("span",Ja,V(e.editData.address),1))]),_:1}),d(n,{label:"端口",prop:"port"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.port,"onUpdate:modelValue":t[3]||(t[3]=s=>e.editData.port=s),type:"text",placeholder:"请输入端口，例如 8888"},null,8,["modelValue"])):(a(),m("span",za,V(e.editData.port),1))]),_:1})]),c("div",Wa,[d(n,{key:"username",label:"用户名",prop:"username"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.username,"onUpdate:modelValue":t[4]||(t[4]=s=>e.editData.username=s),type:"text",placeholder:"请输入用户名"},null,8,["modelValue"])):(a(),m("span",Xa,V(e.editData.username),1))]),_:1}),d(n,{key:"password",class:"password",label:"密码",prop:"password"},{default:o(()=>[l.type===u(p).CHECK?(a(),m("span",Za,"**********")):(a(),m(q,{key:1},[l.type===u(p).ADD?(a(),g(r,{key:0,modelValue:e.editData.password,"onUpdate:modelValue":t[5]||(t[5]=s=>e.editData.password=s),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])):(a(),m(q,{key:1},[e.isEditPassword?(a(),g(r,{key:0,modelValue:e.editData.password,"onUpdate:modelValue":t[6]||(t[6]=s=>e.editData.password=s),type:"password",style:{width:"80%","margin-right":"20px"},placeholder:"请输入密码","show-password":""},null,8,["modelValue"])):re("",!0),c("span",{class:"btn",onClick:t[7]||(t[7]=s=>e.isEditPassword=!e.isEditPassword)},V(e.isEditPassword?"取消":"修改"),1)],64))],64))]),_:1})]),c("div",el,[d(n,{label:"数据源状态",prop:"enable"},{default:o(()=>[d(K,{modelValue:e.editData.enable,"onUpdate:modelValue":t[8]||(t[8]=s=>e.editData.enable=s),disabled:l.type===u(p).CHECK,class:"swith-btn","active-value":!0,"inactive-value":!1},null,8,["modelValue","disabled"])]),_:1})]),c("div",tl,[d(n,{key:"userIds",label:"权限配置",prop:"userIds"},{default:o(()=>[d(D,{modelValue:e.editData.userIds,"onUpdate:modelValue":t[9]||(t[9]=s=>e.editData.userIds=s),class:"member-select",disabled:l.type===u(p).CHECK,multiple:"",filterable:"",clearable:"",placeholder:"请选择",style:{width:"100%"}},{default:o(()=>[(a(!0),m(q,null,X(G.value,s=>(a(),g(_,{key:s.userId,label:s.userName,value:s.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),c("div",al,[d(n,{label:"说明",prop:"description"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.description,"onUpdate:modelValue":t[10]||(t[10]=s=>e.editData.description=s),type:"text",placeholder:"请输入说明",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",ll,V(e.editData.description),1))]),_:1})])]),_:1},8,["model","rules"])])])),[[F,e.isLoading]])])}}}),ol={class:"card"},dl=c("div",{class:"subtitle"},"数据源信息",-1),il={class:"content-wrap"},nl={class:"item-wrap item2"},rl={key:1},ul={key:1},pl={class:"item-wrap item2"},ml={key:1},cl={key:1},yl={class:"item-wrap item2"},fl={key:1},gl={class:"item-wrap"},Dl={class:"item-wrap"},bl={class:"item-wrap"},_l={class:"item-wrap"},hl={key:1},vl=ce({__name:"KafkaForm",props:{type:{default:p.CHECK},curEditId:{default:""},submiting:{type:Boolean,default:!1},checkingConnect:{type:Boolean,default:!1}},emits:["update:submiting","update:checkingConnect","changeType","save"],setup(S,{expose:j,emit:N}){const b=N,w=S,v=oe(),e=ue({isLoading:!1,initData:{id:"",name:"",type:Z.KAFKA,address:"",port:"",topics:"",userIds:[],enable:!0,description:"",dataSample:""},editData:{},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{min:0,max:50,message:"长度在 50 个字符以内",trigger:["blur","change"]}],type:[{required:!0,message:"数据源类型不能为空",trigger:"change"}],address:[{required:!0,message:"数据库地址不能为空",trigger:["blur","change"]}],port:[{required:!0,message:"端口不能为空",trigger:["blur","change"]}]},isLinkSuccess:!0}),f=he("getUserOptions"),G=ye(()=>f==null?void 0:f());ge(()=>{O()});function O(){w.type===p.ADD?e.editData=L.cloneDeep(e.initData):A(w.curEditId),be(()=>{var l;(l=v.value)==null||l.clearValidate()})}function A(l){e.isLoading=!0,x.getDataSourceById(l).then(t=>{if(t.code==="0000"){e.editData=L.cloneDeep(e.initData);for(const r in e.initData)e.editData[r]=t.data[r];e.editData.userIds?e.editData.userIds=e.editData.userIds.split(","):e.editData.userIds=[]}else C({type:"error",message:"获取信息失败"})}).catch(()=>{C({type:"error",message:"获取信息错误"})}).finally(()=>{e.isLoading=!1})}function i(l){b("changeType",l)}function Q(l){return new Promise(t=>{l.validate(r=>{t(r)})})}function R(){Q(v.value).then(t=>{if(t){const r=L.cloneDeep(e.editData);r.userIds=e.editData.userIds.join(","),b("update:submiting",!0);const n=w.type===p.ADD?"addDataSource":"updateDataSource";x[n](r).then(_=>{b("update:submiting",!1),_.code==="0000"?(Y({type:"success",title:`${w.type===p.ADD?"注册":"保存"}成功`}),b("save")):Y({type:"error",title:`${w.type===p.ADD?"注册":"保存"}失败`,message:_.message})}).catch(_=>{b("update:submiting",!1),Y({type:"error",title:`${w.type===p.ADD?"注册":"保存"}错误`,message:_.message})})}})}function M(l=!1){var D;(D=v.value)==null||D.validateField(["type","address","port"]);const{id:t,type:r,address:n,port:_}=L.cloneDeep(e.editData);if(r&&n&&_){l&&b("update:checkingConnect",!0);const K={id:t,type:r,address:n,port:_};x.connectDataBaseTest(K).then(T=>{b("update:checkingConnect",!1),T.code==="0000"?T.data.success?(e.isLinkSuccess=!0,l&&C({type:"success",message:"数据源连接成功"})):(e.isLinkSuccess=!1,l&&C({type:"error",message:"数据源连接失败"})):(e.isLinkSuccess=!1,l&&C({type:"error",message:"数据源连接失败"}))}).catch(()=>{e.isLinkSuccess=!1,b("update:checkingConnect",!1),l&&C({type:"error",message:"数据源连接失败"})})}else C({type:"warning",message:"请先填写相关信息"})}return j({handleCheckConnect:M,handleSaveForm:R}),(l,t)=>{const r=k("el-input"),n=k("el-form-item"),_=k("el-option"),D=k("el-select"),K=k("el-switch"),T=k("el-form"),F=fe("loading");return a(),m("div",ol,[de((a(),m("div",null,[dl,c("div",il,[d(T,{ref_key:"editForm",ref:v,class:"form edit-form",inline:"",model:e.editData,rules:e.rules,"label-width":"auto","label-position":"right"},{default:o(()=>[c("div",nl,[d(n,{label:"数据源名称",prop:"name"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.name,"onUpdate:modelValue":t[0]||(t[0]=s=>e.editData.name=s),type:"text",placeholder:"请输入数据源名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",rl,V(e.editData.name),1))]),_:1}),d(n,{key:"type",label:"数据源类型",prop:"type"},{default:o(()=>{var s;return[l.type===u(p).ADD?(a(),g(D,{key:0,modelValue:e.editData.type,"onUpdate:modelValue":t[1]||(t[1]=h=>e.editData.type=h),style:{width:"100%"},filterable:"",placeholder:"请选择数据源类型",onChange:i},{default:o(()=>[(a(!0),m(q,null,X(u(ae),h=>(a(),g(_,{key:h.code,label:h.name,value:h.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(a(),m("span",ul,V(((s=u(ae).find(h=>h.code===e.editData.type))==null?void 0:s.name)||"未知类型"),1))]}),_:1})]),c("div",pl,[d(n,{label:"数据库地址",prop:"address"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.address,"onUpdate:modelValue":t[2]||(t[2]=s=>e.editData.address=s),type:"text",placeholder:"例如：127.0.0.1"},null,8,["modelValue"])):(a(),m("span",ml,V(e.editData.address),1))]),_:1}),d(n,{label:"端口",prop:"port"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.port,"onUpdate:modelValue":t[3]||(t[3]=s=>e.editData.port=s),type:"text",placeholder:"请输入端口，例如 8888"},null,8,["modelValue"])):(a(),m("span",cl,V(e.editData.port),1))]),_:1})]),c("div",yl,[d(n,{label:"主题",prop:"topics"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.topics,"onUpdate:modelValue":t[4]||(t[4]=s=>e.editData.topics=s),type:"text",placeholder:"请输入主题"},null,8,["modelValue"])):(a(),m("span",fl,V(e.editData.topics),1))]),_:1}),d(n)]),c("div",gl,[d(n,{label:"数据示例",prop:"dataSample"},{default:o(()=>[d(r,{modelValue:e.editData.dataSample,"onUpdate:modelValue":t[5]||(t[5]=s=>e.editData.dataSample=s),type:"textarea",placeholder:"请输入数据示例",clearable:"",readonly:l.type===u(p).CHECK,autosize:{minRows:4,maxRows:6},maxlength:"5000","show-word-limit":""},null,8,["modelValue","readonly"])]),_:1})]),c("div",Dl,[d(n,{label:"数据源状态",prop:"enable"},{default:o(()=>[d(K,{modelValue:e.editData.enable,"onUpdate:modelValue":t[6]||(t[6]=s=>e.editData.enable=s),disabled:l.type===u(p).CHECK,class:"swith-btn","active-value":!0,"inactive-value":!1},null,8,["modelValue","disabled"])]),_:1})]),c("div",bl,[d(n,{key:"userIds",label:"权限配置",prop:"userIds"},{default:o(()=>[d(D,{modelValue:e.editData.userIds,"onUpdate:modelValue":t[7]||(t[7]=s=>e.editData.userIds=s),class:"member-select",disabled:l.type===u(p).CHECK,multiple:"",filterable:"",clearable:"",placeholder:"请选择",style:{width:"100%"}},{default:o(()=>[(a(!0),m(q,null,X(G.value,s=>(a(),g(_,{key:s.userId,label:s.userName,value:s.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),c("div",_l,[d(n,{label:"说明",prop:"description"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.description,"onUpdate:modelValue":t[8]||(t[8]=s=>e.editData.description=s),type:"text",placeholder:"请输入说明",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",hl,V(e.editData.description),1))]),_:1})])]),_:1},8,["model","rules"])])])),[[F,e.isLoading]])])}}}),wl={class:"card"},kl=c("div",{class:"subtitle"},"数据源信息",-1),Vl={class:"content-wrap"},Cl={class:"item-wrap item2"},El={key:1},Il={key:1},Tl={class:"item-wrap item2"},Sl={key:1},$l={key:1},Al={class:"item-wrap item2"},Kl={key:1},Ul={class:"item-wrap"},Hl={class:"item-wrap"},Pl={class:"item-wrap"},Ol={class:"item-wrap"},Bl=ce({__name:"MongoDbForm",props:{type:{default:p.CHECK},curEditId:{default:""},submiting:{type:Boolean,default:!1},checkingConnect:{type:Boolean,default:!1}},emits:["update:submiting","update:checkingConnect","changeType","save"],setup(S,{expose:j,emit:N}){const b=N,w=S,v=oe(),e=ue({isLoading:!1,initData:{id:"",name:"",type:Z.MONGODB,address:"",port:"",dbname:"",userIds:[],enable:!0,description:"",dataSample:""},editData:{},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{min:0,max:50,message:"长度在 50 个字符以内",trigger:["blur","change"]}],type:[{required:!0,message:"数据源类型不能为空",trigger:"change"}],address:[{required:!0,message:"数据库地址不能为空",trigger:["blur","change"]}],port:[{required:!0,message:"端口不能为空",trigger:["blur","change"]}],dbname:[{required:!0,message:"数据库名不能为空",trigger:["blur","change"]}]}}),f=he("getUserOptions"),G=ye(()=>f==null?void 0:f());ge(()=>{O()});function O(){w.type===p.ADD?e.editData=L.cloneDeep(e.initData):A(w.curEditId),be(()=>{var l;(l=v.value)==null||l.clearValidate()})}function A(l){e.isLoading=!0,x.getDataSourceById(l).then(t=>{if(t.code==="0000"){e.editData=L.cloneDeep(e.initData);for(const r in e.initData)e.editData[r]=t.data[r];e.editData.userIds?e.editData.userIds=e.editData.userIds.split(","):e.editData.userIds=[]}else C({type:"error",message:"获取信息失败"})}).catch(()=>{C({type:"error",message:"获取信息错误"})}).finally(()=>{e.isLoading=!1})}function i(l){b("changeType",l)}function Q(l){return new Promise(t=>{l.validate(r=>{t(r)})})}function R(){Q(v.value).then(t=>{if(t){const r=L.cloneDeep(e.editData);r.userIds=e.editData.userIds.join(",");const n=w.type===p.ADD;b("update:submiting",!0),x[n?"addDataSource":"updateDataSource"](r).then(D=>{b("update:submiting",!1),D.code==="0000"?(Y({type:"success",title:`${n?"注册":"保存"}成功`}),b("save")):Y({type:"error",title:`${n?"注册":"保存"}失败`,message:D.message})}).catch(D=>{b("update:submiting",!1),Y({type:"error",title:`${n?"注册":"保存"}错误`,message:D.message})})}})}function M(l=!1){var K;(K=v.value)==null||K.validateField(["type","address","port","dbname"]);const{id:t,type:r,address:n,port:_,dbname:D}=L.cloneDeep(e.editData);if(r&&n&&_&&D){l&&b("update:checkingConnect",!0);const T={id:t,type:r,address:n,port:_,dbname:D};x.connectDataBaseTest(T).then(F=>{b("update:checkingConnect",!1),F.code==="0000"?F.data.success?l&&C({type:"success",message:"数据源连接成功"}):l&&C({type:"error",message:"数据源连接失败"}):l&&C({type:"error",message:"数据源连接失败"})}).catch(()=>{b("update:checkingConnect",!1),l&&C({type:"error",message:"数据源连接失败"})})}else C({type:"warning",message:"请先填写相关信息"})}return j({handleCheckConnect:M,handleSaveForm:R}),(l,t)=>{const r=k("el-input"),n=k("el-form-item"),_=k("el-option"),D=k("el-select"),K=k("el-switch"),T=k("el-form"),F=fe("loading");return a(),m("div",wl,[de((a(),m("div",null,[kl,c("div",Vl,[d(T,{ref_key:"editForm",ref:v,class:"form edit-form",inline:"",model:e.editData,rules:e.rules,"label-width":"auto","label-position":"right"},{default:o(()=>[c("div",Cl,[d(n,{label:"数据源名称",prop:"name"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.name,"onUpdate:modelValue":t[0]||(t[0]=s=>e.editData.name=s),type:"text",placeholder:"请输入数据源名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",El,V(e.editData.name),1))]),_:1}),d(n,{key:"type",label:"数据源类型",prop:"type"},{default:o(()=>{var s;return[l.type===u(p).ADD?(a(),g(D,{key:0,modelValue:e.editData.type,"onUpdate:modelValue":t[1]||(t[1]=h=>e.editData.type=h),style:{width:"100%"},filterable:"",placeholder:"请选择数据源类型",onChange:i},{default:o(()=>[(a(!0),m(q,null,X(u(ae),h=>(a(),g(_,{key:h.code,label:h.name,value:h.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(a(),m("span",Il,V(((s=u(ae).find(h=>h.code===e.editData.type))==null?void 0:s.name)||"未知类型"),1))]}),_:1})]),c("div",Tl,[d(n,{label:"数据库地址",prop:"address"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.address,"onUpdate:modelValue":t[2]||(t[2]=s=>e.editData.address=s),type:"text",placeholder:"例如：127.0.0.1"},null,8,["modelValue"])):(a(),m("span",Sl,V(e.editData.address),1))]),_:1}),d(n,{label:"端口",prop:"port"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.port,"onUpdate:modelValue":t[3]||(t[3]=s=>e.editData.port=s),type:"text",placeholder:"请输入端口，例如 8888"},null,8,["modelValue"])):(a(),m("span",$l,V(e.editData.port),1))]),_:1})]),c("div",Al,[d(n,{label:"数据库名",prop:"dbname"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.dbname,"onUpdate:modelValue":t[4]||(t[4]=s=>e.editData.dbname=s),type:"text",placeholder:"请输入数据库名"},null,8,["modelValue"])):(a(),m("span",Kl,V(e.editData.dbname),1))]),_:1}),d(n)]),c("div",Ul,[d(n,{label:"数据示例",prop:"dataSample"},{default:o(()=>[d(r,{modelValue:e.editData.dataSample,"onUpdate:modelValue":t[5]||(t[5]=s=>e.editData.dataSample=s),type:"textarea",placeholder:"请输入数据示例",clearable:"",readonly:l.type===u(p).CHECK,autosize:{minRows:4,maxRows:6},maxlength:"5000","show-word-limit":""},null,8,["modelValue","readonly"])]),_:1})]),c("div",Hl,[d(n,{label:"数据源状态",prop:"enable"},{default:o(()=>[d(K,{modelValue:e.editData.enable,"onUpdate:modelValue":t[6]||(t[6]=s=>e.editData.enable=s),disabled:l.type===u(p).CHECK,class:"swith-btn","active-value":!0,"inactive-value":!1},null,8,["modelValue","disabled"])]),_:1})]),c("div",Pl,[d(n,{key:"userIds",label:"权限配置",prop:"userIds"},{default:o(()=>[d(D,{modelValue:e.editData.userIds,"onUpdate:modelValue":t[7]||(t[7]=s=>e.editData.userIds=s),class:"member-select",disabled:l.type===u(p).CHECK,multiple:"",filterable:"",clearable:"",placeholder:"请选择",style:{width:"100%"}},{default:o(()=>[(a(!0),m(q,null,X(G.value,s=>(a(),g(_,{key:s.userId,label:s.userName,value:s.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),c("div",Ol,[d(n,{label:"说明",prop:"description"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.description,"onUpdate:modelValue":t[8]||(t[8]=s=>e.editData.description=s),type:"text",placeholder:"请输入说明",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",{key:1,class:Ue([e.editData.description?"":"empty"])},V(e.editData.description||"未说明"),3))]),_:1})])]),_:1},8,["model","rules"])])])),[[F,e.isLoading]])])}}}),Ll={class:"card"},Rl=c("div",{class:"subtitle"},"数据源信息",-1),ql={class:"content-wrap"},Nl={class:"item-wrap item2"},Fl={key:1},xl={key:1},jl={class:"item-wrap item2"},Gl={key:1},Ml={key:1},Ql={class:"item-wrap"},Yl={class:"item-wrap"},Jl={class:"item-wrap"},zl={class:"item-wrap"},Wl={key:1},Xl=ce({__name:"ElasticSearchForm",props:{type:{default:p.CHECK},curEditId:{default:""},submiting:{type:Boolean,default:!1},checkingConnect:{type:Boolean,default:!1}},emits:["update:submiting","update:checkingConnect","changeType","save"],setup(S,{expose:j,emit:N}){const b=N,w=S,v=oe(),e=ue({isLoading:!1,initData:{id:"",name:"",type:Z.ELASTICSEARCH,address:"",port:"",userIds:[],enable:!0,description:"",dataSample:""},editData:{},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{min:0,max:50,message:"长度在 50 个字符以内",trigger:["blur","change"]}],type:[{required:!0,message:"数据源类型不能为空",trigger:"change"}],address:[{required:!0,message:"数据库地址不能为空",trigger:["blur","change"]}],port:[{required:!0,message:"端口不能为空",trigger:["blur","change"]}]},isLinkSuccess:!0}),f=he("getUserOptions"),G=ye(()=>f==null?void 0:f());ge(()=>{O()});function O(){w.type===p.ADD?e.editData=L.cloneDeep(e.initData):A(w.curEditId),be(()=>{var l;(l=v.value)==null||l.clearValidate()})}function A(l){e.isLoading=!0,x.getDataSourceById(l).then(t=>{if(t.code==="0000"){e.editData=L.cloneDeep(e.initData);for(const r in e.initData)e.editData[r]=t.data[r];e.editData.userIds?e.editData.userIds=e.editData.userIds.split(","):e.editData.userIds=[]}else C({type:"error",message:"获取信息失败"})}).catch(()=>{C({type:"error",message:"获取信息错误"})}).finally(()=>{e.isLoading=!1})}function i(l){b("changeType",l)}function Q(l){return new Promise(t=>{l.validate(r=>{t(r)})})}function R(){Q(v.value).then(t=>{if(t){const r=L.cloneDeep(e.editData);r.userIds=e.editData.userIds.join(",");const n=w.type===p.ADD;b("update:submiting",!0),x[n?"addDataSource":"updateDataSource"](r).then(D=>{b("update:submiting",!1),D.code==="0000"?(Y({type:"success",title:`${n?"注册":"保存"}成功`}),b("save")):Y({type:"error",title:`${n?"注册":"保存"}失败`,message:D.message})}).catch(D=>{b("update:submiting",!1),Y({type:"error",title:`${n?"注册":"保存"}错误`,message:D.message})})}})}function M(l=!1){var D;(D=v.value)==null||D.validateField(["type","address","port"]);const{id:t,type:r,address:n,port:_}=L.cloneDeep(e.editData);if(r&&n&&_){l&&b("update:checkingConnect",!0);const K={id:t,type:r,address:n,port:_};x.connectDataBaseTest(K).then(T=>{b("update:checkingConnect",!1),T.code==="0000"?T.data.success?(e.isLinkSuccess=!0,l&&C({type:"success",message:"数据源连接成功"})):(e.isLinkSuccess=!1,l&&C({type:"error",message:"数据源连接失败"})):(e.isLinkSuccess=!1,l&&C({type:"error",message:"数据源连接失败"}))}).catch(()=>{e.isLinkSuccess=!1,b("update:checkingConnect",!1),l&&C({type:"error",message:"数据源连接失败"})})}else C({type:"warning",message:"请先填写相关信息"})}return j({handleCheckConnect:M,handleSaveForm:R}),(l,t)=>{const r=k("el-input"),n=k("el-form-item"),_=k("el-option"),D=k("el-select"),K=k("el-switch"),T=k("el-form"),F=fe("loading");return a(),m("div",Ll,[de((a(),m("div",null,[Rl,c("div",ql,[d(T,{ref_key:"editForm",ref:v,class:"form edit-form",inline:"",model:e.editData,rules:e.rules,"label-width":"auto","label-position":"right"},{default:o(()=>[c("div",Nl,[d(n,{label:"数据源名称",prop:"name"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.name,"onUpdate:modelValue":t[0]||(t[0]=s=>e.editData.name=s),type:"text",placeholder:"请输入数据源名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",Fl,V(e.editData.name),1))]),_:1}),d(n,{key:"type",label:"数据源类型",prop:"type"},{default:o(()=>{var s;return[l.type===u(p).ADD?(a(),g(D,{key:0,modelValue:e.editData.type,"onUpdate:modelValue":t[1]||(t[1]=h=>e.editData.type=h),style:{width:"100%"},filterable:"",placeholder:"请选择数据源类型",onChange:i},{default:o(()=>[(a(!0),m(q,null,X(u(ae),h=>(a(),g(_,{key:h.code,label:h.name,value:h.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(a(),m("span",xl,V(((s=u(ae).find(h=>h.code===e.editData.type))==null?void 0:s.name)||"未知类型"),1))]}),_:1})]),c("div",jl,[d(n,{label:"数据库地址",prop:"address"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.address,"onUpdate:modelValue":t[2]||(t[2]=s=>e.editData.address=s),type:"text",placeholder:"例如：127.0.0.1"},null,8,["modelValue"])):(a(),m("span",Gl,V(e.editData.address),1))]),_:1}),d(n,{label:"端口",prop:"port"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.port,"onUpdate:modelValue":t[3]||(t[3]=s=>e.editData.port=s),type:"text",placeholder:"请输入端口，例如 8888"},null,8,["modelValue"])):(a(),m("span",Ml,V(e.editData.port),1))]),_:1})]),c("div",Ql,[d(n,{label:"数据示例",prop:"dataSample"},{default:o(()=>[d(r,{modelValue:e.editData.dataSample,"onUpdate:modelValue":t[4]||(t[4]=s=>e.editData.dataSample=s),type:"textarea",placeholder:"请输入数据示例",clearable:"",readonly:l.type===u(p).CHECK,autosize:{minRows:4,maxRows:6},maxlength:"5000","show-word-limit":""},null,8,["modelValue","readonly"])]),_:1})]),c("div",Yl,[d(n,{label:"数据源状态",prop:"enable"},{default:o(()=>[d(K,{modelValue:e.editData.enable,"onUpdate:modelValue":t[5]||(t[5]=s=>e.editData.enable=s),disabled:l.type===u(p).CHECK,class:"swith-btn","active-value":!0,"inactive-value":!1},null,8,["modelValue","disabled"])]),_:1})]),c("div",Jl,[d(n,{key:"userIds",label:"权限配置",prop:"userIds"},{default:o(()=>[d(D,{modelValue:e.editData.userIds,"onUpdate:modelValue":t[6]||(t[6]=s=>e.editData.userIds=s),class:"member-select",disabled:l.type===u(p).CHECK,multiple:"",filterable:"",clearable:"",placeholder:"请选择",style:{width:"100%"}},{default:o(()=>[(a(!0),m(q,null,X(G.value,s=>(a(),g(_,{key:s.userId,label:s.userName,value:s.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),c("div",zl,[d(n,{label:"说明",prop:"description"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.description,"onUpdate:modelValue":t[7]||(t[7]=s=>e.editData.description=s),type:"text",placeholder:"请输入说明",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",Wl,V(e.editData.description),1))]),_:1})])]),_:1},8,["model","rules"])])])),[[F,e.isLoading]])])}}}),Zl={class:"card"},es=c("div",{class:"subtitle"},"数据源信息",-1),ts={class:"content-wrap"},as={class:"item-wrap item2"},ls={key:1},ss={key:1},os={class:"item-wrap item2"},ds={key:1},is={key:1},ns={class:"item-wrap"},rs={class:"item-wrap"},us={class:"item-wrap"},ps={class:"item-wrap"},ms={key:1},cs=ce({__name:"HdfsForm",props:{type:{default:p.CHECK},curEditId:{default:""},submiting:{type:Boolean,default:!1},checkingConnect:{type:Boolean,default:!1}},emits:["update:submiting","update:checkingConnect","changeType","save"],setup(S,{expose:j,emit:N}){const b=N,w=S,v=oe(),e=ue({isLoading:!1,initData:{id:"",name:"",type:Z.HDFS,address:"",port:"",userIds:[],enable:!0,description:"",dataSample:""},editData:{},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{min:0,max:50,message:"长度在 50 个字符以内",trigger:["blur","change"]}],type:[{required:!0,message:"数据源类型不能为空",trigger:"change"}],address:[{required:!0,message:"数据库地址不能为空",trigger:["blur","change"]}],port:[{required:!0,message:"端口不能为空",trigger:["blur","change"]}]},isLinkSuccess:!0}),f=he("getUserOptions"),G=ye(()=>f==null?void 0:f());ge(()=>{O()});function O(){w.type===p.ADD?e.editData=L.cloneDeep(e.initData):A(w.curEditId),be(()=>{var l;(l=v.value)==null||l.clearValidate()})}function A(l){e.isLoading=!0,x.getDataSourceById(l).then(t=>{if(t.code==="0000"){e.editData=L.cloneDeep(e.initData);for(const r in e.initData)e.editData[r]=t.data[r];e.editData.userIds?e.editData.userIds=e.editData.userIds.split(","):e.editData.userIds=[]}else C({type:"error",message:"获取信息失败"})}).catch(()=>{C({type:"error",message:"获取信息错误"})}).finally(()=>{e.isLoading=!1})}function i(l){b("changeType",l)}function Q(l){return new Promise(t=>{l.validate(r=>{t(r)})})}function R(){Q(v.value).then(t=>{if(t){const r=L.cloneDeep(e.editData);r.userIds=e.editData.userIds.join(",");const n=w.type===p.ADD;b("update:submiting",!0),x[n?"addDataSource":"updateDataSource"](r).then(D=>{b("update:submiting",!1),D.code==="0000"?(Y({type:"success",title:`${n?"注册":"保存"}成功`}),b("save")):Y({type:"error",title:`${n?"注册":"保存"}失败`,message:D.message})}).catch(D=>{b("update:submiting",!1),Y({type:"error",title:`${n?"注册":"保存"}错误`,message:D.message})})}})}function M(l=!1){var D;(D=v.value)==null||D.validateField(["type","address","port"]);const{id:t,type:r,address:n,port:_}=L.cloneDeep(e.editData);if(r&&n&&_){l&&b("update:checkingConnect",!0);const K={id:t,type:r,address:n,port:_};x.connectDataBaseTest(K).then(T=>{b("update:checkingConnect",!1),T.code==="0000"?T.data.success?(e.isLinkSuccess=!0,l&&C({type:"success",message:"数据源连接成功"})):(e.isLinkSuccess=!1,l&&C({type:"error",message:"数据源连接失败"})):(e.isLinkSuccess=!1,l&&C({type:"error",message:"数据源连接失败"}))}).catch(()=>{e.isLinkSuccess=!1,b("update:checkingConnect",!1),l&&C({type:"error",message:"数据源连接失败"})})}else C({type:"warning",message:"请先填写相关信息"})}return j({handleCheckConnect:M,handleSaveForm:R}),(l,t)=>{const r=k("el-input"),n=k("el-form-item"),_=k("el-option"),D=k("el-select"),K=k("el-switch"),T=k("el-form"),F=fe("loading");return a(),m("div",Zl,[de((a(),m("div",null,[es,c("div",ts,[d(T,{ref_key:"editForm",ref:v,class:"form edit-form",inline:"",model:e.editData,rules:e.rules,"label-width":"auto","label-position":"right"},{default:o(()=>[c("div",as,[d(n,{label:"数据源名称",prop:"name"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.name,"onUpdate:modelValue":t[0]||(t[0]=s=>e.editData.name=s),type:"text",placeholder:"请输入数据源名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",ls,V(e.editData.name),1))]),_:1}),d(n,{key:"type",label:"数据源类型",prop:"type"},{default:o(()=>{var s;return[l.type===u(p).ADD?(a(),g(D,{key:0,modelValue:e.editData.type,"onUpdate:modelValue":t[1]||(t[1]=h=>e.editData.type=h),style:{width:"100%"},filterable:"",placeholder:"请选择数据源类型",onChange:i},{default:o(()=>[(a(!0),m(q,null,X(u(ae),h=>(a(),g(_,{key:h.code,label:h.name,value:h.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(a(),m("span",ss,V(((s=u(ae).find(h=>h.code===e.editData.type))==null?void 0:s.name)||"未知类型"),1))]}),_:1})]),c("div",os,[d(n,{label:"数据库地址",prop:"address"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.address,"onUpdate:modelValue":t[2]||(t[2]=s=>e.editData.address=s),type:"text",placeholder:"例如：127.0.0.1"},null,8,["modelValue"])):(a(),m("span",ds,V(e.editData.address),1))]),_:1}),d(n,{label:"端口",prop:"port"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.port,"onUpdate:modelValue":t[3]||(t[3]=s=>e.editData.port=s),type:"text",placeholder:"请输入端口，例如 8888"},null,8,["modelValue"])):(a(),m("span",is,V(e.editData.port),1))]),_:1})]),c("div",ns,[d(n,{label:"数据示例",prop:"dataSample"},{default:o(()=>[d(r,{modelValue:e.editData.dataSample,"onUpdate:modelValue":t[4]||(t[4]=s=>e.editData.dataSample=s),type:"textarea",placeholder:"请输入数据示例",clearable:"",readonly:l.type===u(p).CHECK,autosize:{minRows:4,maxRows:6},maxlength:"5000","show-word-limit":""},null,8,["modelValue","readonly"])]),_:1})]),c("div",rs,[d(n,{label:"数据源状态",prop:"enable"},{default:o(()=>[d(K,{modelValue:e.editData.enable,"onUpdate:modelValue":t[5]||(t[5]=s=>e.editData.enable=s),disabled:l.type===u(p).CHECK,class:"swith-btn","active-value":!0,"inactive-value":!1},null,8,["modelValue","disabled"])]),_:1})]),c("div",us,[d(n,{key:"userIds",label:"权限配置",prop:"userIds"},{default:o(()=>[d(D,{modelValue:e.editData.userIds,"onUpdate:modelValue":t[6]||(t[6]=s=>e.editData.userIds=s),class:"member-select",disabled:l.type===u(p).CHECK,multiple:"",filterable:"",clearable:"",placeholder:"请选择",style:{width:"100%"}},{default:o(()=>[(a(!0),m(q,null,X(G.value,s=>(a(),g(_,{key:s.userId,label:s.userName,value:s.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),c("div",ps,[d(n,{label:"说明",prop:"description"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.description,"onUpdate:modelValue":t[7]||(t[7]=s=>e.editData.description=s),type:"text",placeholder:"请输入说明",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",ms,V(e.editData.description),1))]),_:1})])]),_:1},8,["model","rules"])])])),[[F,e.isLoading]])])}}}),ys={class:"card"},fs=c("div",{class:"subtitle"},"数据源信息",-1),gs={class:"content-wrap"},Ds={class:"item-wrap item2"},bs={key:1},_s={key:1},hs={class:"item-wrap item2"},vs={key:1},ws={key:1},ks={class:"item-wrap item2"},Vs={key:1},Cs={class:"item-wrap item2"},Es={key:1},Is={key:0},Ts={class:"item-wrap"},Ss={class:"item-wrap"},$s={class:"item-wrap"},As={key:1},Ks=ce({__name:"KingBaseForm",props:{type:{default:p.CHECK},curEditId:{default:""},submiting:{type:Boolean,default:!1},checkingConnect:{type:Boolean,default:!1}},emits:["update:submiting","update:checkingConnect","changeType","save"],setup(S,{expose:j,emit:N}){const b=N,w=S,v=oe(),e=ue({isLoading:!1,initData:{id:"",name:"",type:Z.KINGBASE,address:"",port:"",dbname:"",username:"",password:"",userIds:[],enable:!0,description:""},editData:{},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{min:0,max:50,message:"长度在 50 个字符以内",trigger:["blur","change"]}],type:[{required:!0,message:"数据源类型不能为空",trigger:"change"}],address:[{required:!0,message:"数据库地址不能为空",trigger:["blur","change"]}],port:[{required:!0,message:"端口不能为空",trigger:["blur","change"]}],dbname:[{required:!0,message:"数据库名不能为空",trigger:["blur","change"]}],username:[{required:!0,message:"用户名不能为空",trigger:["blur","change"]}],password:[{required:!0,message:"密码不能为空",trigger:["blur","change"]}]},isLinkSuccess:!0,isEditPassword:!1});Ve(()=>e.isEditPassword,l=>{var t;l?e.editData.password="":w.type===p.EDIT&&(e.editData.password="xxxx"),(t=v.value)==null||t.clearValidate("password")});const f=he("getUserOptions"),G=ye(()=>f==null?void 0:f());ge(()=>{O()});function O(){e.isEditPassword=!1,w.type===p.ADD?e.editData=L.cloneDeep(e.initData):A(w.curEditId),be(()=>{var l;(l=v.value)==null||l.clearValidate()})}function A(l){e.isLoading=!0,x.getDataSourceById(l).then(t=>{if(t.code==="0000"){e.editData=L.cloneDeep(e.initData);for(const r in e.initData)e.editData[r]=t.data[r];e.editData.userIds?e.editData.userIds=e.editData.userIds.split(","):e.editData.userIds=[]}else C({type:"error",message:"获取信息失败"})}).catch(()=>{C({type:"error",message:"获取信息错误"})}).finally(()=>{e.isLoading=!1})}function i(l){b("changeType",l)}function Q(l){return new Promise(t=>{l.validate(r=>{t(r)})})}function R(){Q(v.value).then(t=>{if(t){const r=L.cloneDeep(e.editData);r.userIds=e.editData.userIds.join(",");const n=w.type===p.ADD;n||e.isEditPassword?r.password=ke.rsaEncrypt(r.password):delete r.password,b("update:submiting",!0),x[n?"addDataSource":"updateDataSource"](r).then(D=>{b("update:submiting",!1),D.code==="0000"?(Y({type:"success",title:`${n?"注册":"保存"}成功`}),b("save")):Y({type:"error",title:`${n?"注册":"保存"}失败`,message:D.message})}).catch(D=>{b("update:submiting",!1),Y({type:"error",title:`${n?"注册":"保存"}错误`,message:D.message})})}})}function M(l=!1){var h,$;(h=v.value)==null||h.validateField(["type","address","port","dbname","username"]);const t=w.type===p.ADD;(e.isEditPassword||t)&&(($=v.value)==null||$.validateField(["password"]));const{id:r,type:n,address:_,port:D,dbname:K,username:T,password:F}=L.cloneDeep(e.editData);if((t||e.isEditPassword?!!F:!0)&&n&&_&&D&&K&&T){l&&b("update:checkingConnect",!0);const z={id:r,type:n,address:_,port:D,dbname:K,username:T};(e.isEditPassword||t)&&(z.password=ke.rsaEncrypt(F)),x.connectDataBaseTest(z).then(ne=>{b("update:checkingConnect",!1),ne.code==="0000"?ne.data.success?(e.isLinkSuccess=!0,l&&C({type:"success",message:"数据源连接成功"})):(e.isLinkSuccess=!1,l&&C({type:"error",message:"数据源连接失败"})):(e.isLinkSuccess=!1,l&&C({type:"error",message:"数据源连接失败"}))}).catch(()=>{e.isLinkSuccess=!1,b("update:checkingConnect",!1),l&&C({type:"error",message:"数据源连接失败"})})}else C({type:"warning",message:"请先填写相关信息"})}return j({handleCheckConnect:M,handleSaveForm:R}),(l,t)=>{const r=k("el-input"),n=k("el-form-item"),_=k("el-option"),D=k("el-select"),K=k("el-switch"),T=k("el-form"),F=fe("loading");return a(),m("div",ys,[de((a(),m("div",null,[fs,c("div",gs,[d(T,{ref_key:"editForm",ref:v,class:"form edit-form",inline:"",model:e.editData,rules:e.rules,"label-width":"auto","label-position":"right"},{default:o(()=>[c("div",Ds,[d(n,{label:"数据源名称",prop:"name"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.name,"onUpdate:modelValue":t[0]||(t[0]=s=>e.editData.name=s),type:"text",placeholder:"请输入数据源名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",bs,V(e.editData.name),1))]),_:1}),d(n,{key:"type",label:"数据源类型",prop:"type"},{default:o(()=>{var s;return[l.type===u(p).ADD?(a(),g(D,{key:0,modelValue:e.editData.type,"onUpdate:modelValue":t[1]||(t[1]=h=>e.editData.type=h),style:{width:"100%"},filterable:"",placeholder:"请选择数据源类型",onChange:i},{default:o(()=>[(a(!0),m(q,null,X(u(ae),h=>(a(),g(_,{key:h.code,label:h.name,value:h.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(a(),m("span",_s,V(((s=u(ae).find(h=>h.code===e.editData.type))==null?void 0:s.name)||"未知类型"),1))]}),_:1})]),c("div",hs,[d(n,{label:"数据库地址",prop:"address"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.address,"onUpdate:modelValue":t[2]||(t[2]=s=>e.editData.address=s),type:"text",placeholder:"例如：127.0.0.1"},null,8,["modelValue"])):(a(),m("span",vs,V(e.editData.address),1))]),_:1}),d(n,{label:"端口",prop:"port"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.port,"onUpdate:modelValue":t[3]||(t[3]=s=>e.editData.port=s),type:"text",placeholder:"请输入端口，例如 8888"},null,8,["modelValue"])):(a(),m("span",ws,V(e.editData.port),1))]),_:1})]),c("div",ks,[d(n,{label:"数据库名",prop:"dbname"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.dbname,"onUpdate:modelValue":t[4]||(t[4]=s=>e.editData.dbname=s),type:"text",placeholder:"请输入数据库名"},null,8,["modelValue"])):(a(),m("span",Vs,V(e.editData.dbname),1))]),_:1}),d(n)]),c("div",Cs,[d(n,{key:"username",label:"用户名",prop:"username"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.username,"onUpdate:modelValue":t[5]||(t[5]=s=>e.editData.username=s),type:"text",placeholder:"请输入用户名"},null,8,["modelValue"])):(a(),m("span",Es,V(e.editData.username),1))]),_:1}),d(n,{key:"password",class:"password",label:"密码",prop:"password"},{default:o(()=>[l.type===u(p).CHECK?(a(),m("span",Is,"**********")):(a(),m(q,{key:1},[l.type===u(p).ADD?(a(),g(r,{key:0,modelValue:e.editData.password,"onUpdate:modelValue":t[6]||(t[6]=s=>e.editData.password=s),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])):(a(),m(q,{key:1},[e.isEditPassword?(a(),g(r,{key:0,modelValue:e.editData.password,"onUpdate:modelValue":t[7]||(t[7]=s=>e.editData.password=s),type:"password",style:{width:"80%","margin-right":"20px"},placeholder:"请输入密码","show-password":""},null,8,["modelValue"])):re("",!0),c("span",{class:"btn",onClick:t[8]||(t[8]=s=>e.isEditPassword=!e.isEditPassword)},V(e.isEditPassword?"取消":"修改"),1)],64))],64))]),_:1})]),c("div",Ts,[d(n,{label:"数据源状态",prop:"enable"},{default:o(()=>[d(K,{modelValue:e.editData.enable,"onUpdate:modelValue":t[9]||(t[9]=s=>e.editData.enable=s),disabled:l.type===u(p).CHECK,class:"swith-btn","active-value":!0,"inactive-value":!1},null,8,["modelValue","disabled"])]),_:1})]),c("div",Ss,[d(n,{key:"userIds",label:"权限配置",prop:"userIds"},{default:o(()=>[d(D,{modelValue:e.editData.userIds,"onUpdate:modelValue":t[10]||(t[10]=s=>e.editData.userIds=s),class:"member-select",disabled:l.type===u(p).CHECK,multiple:"",filterable:"",clearable:"",placeholder:"请选择",style:{width:"100%"}},{default:o(()=>[(a(!0),m(q,null,X(G.value,s=>(a(),g(_,{key:s.userId,label:s.userName,value:s.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),c("div",$s,[d(n,{label:"说明",prop:"description"},{default:o(()=>[l.type!==u(p).CHECK?(a(),g(r,{key:0,modelValue:e.editData.description,"onUpdate:modelValue":t[11]||(t[11]=s=>e.editData.description=s),type:"text",placeholder:"请输入说明",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue"])):(a(),m("span",As,V(e.editData.description),1))]),_:1})])]),_:1},8,["model","rules"])])])),[[F,e.isLoading]])])}}}),Us={class:"main-content"},Hs={class:"title"},Ps={class:"main"},Os={class:"footer"},Bs=ce({__name:"DatasourceInfoDialog",props:{visible:{type:Boolean,default:!1},dialogType:{default:p.CHECK},domId:{default:""},curEditId:{default:""},dataSourceType:{}},emits:["update:visible","changeEdit","save"],setup(S,{emit:j}){const N=j,b=S,w=oe(),v=ue({isLoadingComp:!1,dialogVisible:!1,submiting:!1,isChecking:!1,userOptions:[],renderType:Z.NONE});Le("getUserOptions",e);function e(){return v.userOptions}const f=ye(()=>({[Z.POSTGIS]:wt,[Z.MYSQL]:Nt,[Z.RESTAPI]:Na,[Z.NEBULAGRAPH]:sl,[Z.KAFKA]:vl,[Z.MONGODB]:Bl,[Z.ELASTICSEARCH]:Xl,[Z.HDFS]:cs,[Z.NONE]:null,[Z.KINGBASE]:Ks})[v.renderType]);Ve(()=>b.visible,l=>{v.dialogVisible=l});function G(){A(),v.renderType=b.dataSourceType}function O(l=!1){N("update:visible",!1),v.renderType=Z.NONE,l&&N("save")}function A(){x.getUserPageList().then(l=>{l.code==="0000"?v.userOptions=l.data:C({type:"error",message:l.message||"获取用户列表数据失败"})}).catch(l=>{C({type:"error",message:l.message||"获取用户列表数据错误"})})}function i(l){v.renderType=l}function Q(){N("changeEdit")}function R(){var l;(l=w.value)==null||l.handleSaveForm()}function M(l=!1){var t;(t=w.value)==null||t.handleCheckConnect(l)}return(l,t)=>{const r=k("ArrowLeft"),n=k("el-icon"),_=k("el-button"),D=fe("action"),K=fe("loading");return a(),g(u(We),{id:"datasource-full-dialog",modelValue:v.dialogVisible,"onUpdate:modelValue":t[6]||(t[6]=T=>v.dialogVisible=T),class:"full-dialog common-full-dialog","append-to-dom":l.domId,"modal-append-to-body":!1,fullscreen:"","is-custom":"","close-on-press-escape":!1,onOpen:G,onClosed:O},{default:o(()=>[de((a(),m("div",Us,[c("div",Hs,[d(n,{onClick:t[0]||(t[0]=T=>O(!1))},{default:o(()=>[d(r)]),_:1}),c("span",null,V((l.dialogType===u(p).ADD?"注册":u(ze).get(l.dialogType)||"查看")+"数据源"),1)]),c("div",Ps,[(a(),g(Re(f.value),{ref_key:"formCompRef",ref:w,submiting:v.submiting,"onUpdate:submiting":t[1]||(t[1]=T=>v.submiting=T),checkingConnect:v.isChecking,"onUpdate:checkingConnect":t[2]||(t[2]=T=>v.isChecking=T),name:v.renderType,type:l.dialogType,"cur-edit-id":l.curEditId,onChangeType:i,onSave:t[3]||(t[3]=T=>O(!0))},null,40,["submiting","checkingConnect","name","type","cur-edit-id"]))]),c("div",Os,[d(_,{onClick:t[4]||(t[4]=T=>v.dialogVisible=!1)},{default:o(()=>[W("取消")]),_:1}),l.dialogType!==u(p).CHECK?(a(),g(_,{key:0,type:"primary",plain:"",loading:v.isChecking,onClick:t[5]||(t[5]=T=>M(!0))},{default:o(()=>[W("测试连接")]),_:1},8,["loading"])):re("",!0),l.dialogType!==u(p).CHECK?de((a(),g(_,{key:1,type:"primary",loading:v.submiting,onClick:R},{default:o(()=>[W("保存")]),_:1},8,["loading"])),[[D,"datasource_manager_save"]]):(a(),g(_,{key:2,type:"primary",onClick:Q},{default:o(()=>[W("编辑")]),_:1}))])])),[[K,v.isLoadingComp]])]),_:1},8,["modelValue","append-to-dom"])}}});const Ls={class:"main-content"},Rs={class:"dialog-footer"},qs=ce({__name:"UserPermissionDialog",props:{visible:{type:Boolean,default:!1},editId:{default:""}},emits:["update:visible","save"],setup(S,{emit:j}){const N=j,b=S,w=ue({dialogVisible:!1,editData:{},userOptions:[]});Ve(()=>b.visible,A=>{w.dialogVisible=A});function v(){e(),f(b.editId)}function e(){x.getUserPageList().then(A=>{A.code==="0000"?w.userOptions=A.data:C({type:"error",message:A.message||"获取用户列表数据失败"})}).catch(A=>{C({type:"error",message:A.message||"获取用户列表数据错误"})})}function f(A){x.getDataSourceById(A).then(i=>{i.code==="0000"?(w.editData.id=i.data.id,w.editData.enable=i.data.enable,w.editData.userIds=i.data.userIds,w.editData.userIds?w.editData.userIds=w.editData.userIds.split(","):w.editData.userIds=[]):C({type:"error",message:"获取信息失败"})}).catch(()=>{C({type:"error",message:"获取信息错误"})})}function G(){N("update:visible",!1)}function O(){const{id:A,userIds:i,enable:Q}=w.editData,R={id:A,enable:Q,userIds:i.join(",")};x.updateDataSource(R).then(M=>{M.code==="0000"?(Y({type:"success",title:"权限配置成功"}),N("save"),G()):Y({type:"error",title:"权限配置失败",message:M.message})}).catch(M=>{Y({type:"error",title:"权限配置错误",message:M.message})})}return(A,i)=>{const Q=k("el-option"),R=k("el-select"),M=k("el-button"),l=k("el-dialog");return a(),g(l,{modelValue:w.dialogVisible,"onUpdate:modelValue":i[1]||(i[1]=t=>w.dialogVisible=t),class:"center-dialog",width:"400px","append-to-body":!1,"close-on-press-escape":!1,title:"权限配置",onOpen:v,onClosed:G},{footer:o(()=>[c("span",Rs,[d(M,{onClick:G},{default:o(()=>[W("取 消")]),_:1}),d(M,{type:"primary",onClick:O},{default:o(()=>[W("保 存")]),_:1})])]),default:o(()=>[c("div",Ls,[d(R,{modelValue:w.editData.userIds,"onUpdate:modelValue":i[0]||(i[0]=t=>w.editData.userIds=t),class:"member-select",multiple:"",filterable:"",clearable:"",placeholder:"请选择",style:{width:"100%"}},{default:o(()=>[(a(!0),m(q,null,X(w.userOptions,t=>(a(),g(Q,{key:t.userId,label:t.userName,value:t.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])}}});function Ns(){const S=ue({searchOptions:[{label:"关键字",key:"keyword",type:"text",placeholder:"名称/EPSG编码",span:5},{label:"类型",key:"type",type:"select",options:ae.map(j=>({...j,label:j.name,value:j.code})),clearable:!0,span:4},{label:"状态",key:"enable",type:"select",options:[{label:"所有",value:""},{label:"启动",value:1},{label:"禁用",value:0}],clearable:!0,span:4}],columns:[{prop:"name",label:"数据源名称",minWidth:120,slot:"name",sortable:!0},{prop:"type",label:"数据源类型",minWidth:120,sortable:!0,slot:"type"},{prop:"address",label:"数据库地址",minWidth:120,sortable:!0},{prop:"creator",label:"创建人",minWidth:120,sortable:!0},{prop:"createTime",label:"创建时间",minWidth:120,sortable:!0},{prop:"description",label:"描述",minWidth:120,sortable:!0},{prop:"enable",label:"数据源状态",minWidth:120,slot:"enable"}]});return ge(()=>{}),{...qe(S)}}const Fs=ce({__name:"index",setup(S){const{searchOptions:j,columns:N}=Ns(),b=oe(),{data:w,total:v,pageNo:e,pageSize:f,loading:G,handleSizeChange:O,handleCurrentChange:A,handleSelectionChange:i,handleSearch:Q,initData:R}=Ne(x.getDataSourcePageList),{checkPermission:M}=Je(),l=oe(),t=ue({domId:"datasource-manage",dialogVisible:!1,dialogType:p.CHECK,curEditId:"",dataSourceType:Z.NONE,permissionDialogVisible:!1,permissionSetId:""});ge(()=>{R()});function r(s){t.curEditId="",t.dialogType=p.ADD,t.dataSourceType=s,t.dialogVisible=!0}function n(s,h){w.value.length!==0&&x.changeDataSourceStatus(h.id,h.enable).then($=>{$.code==="0000"&&Y({title:"提示",message:`数据源已${h.enable?"启动":"禁用"}！`,type:"success",duration:2e3}),R()}).catch(()=>{R()})}function _(s){M("datasource_manager_get")&&(t.curEditId=s.id,t.dialogType=p.CHECK,t.dataSourceType=s.type.toUpperCase(),t.dialogVisible=!0)}function D(s,h=!1){h||(t.curEditId=s.id,t.dialogType=p.EDIT,t.dataSourceType=s.type.toUpperCase(),t.dialogVisible=!0)}function K(s){t.permissionSetId=s.id,t.permissionDialogVisible=!0}function T(){t.dialogType=p.EDIT}function F(s,h=!1){h||Se.confirm(`删除【${s.name}】数据源, 是否继续?`,"提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then(()=>{G.value=!0,x.deleteDataSourceByIds(s.id).then($=>{G.value=!1,$.code==="0000"&&(Y({type:"success",title:"删除数据源成功"}),R())})}).catch(()=>{})}return(s,h)=>{const $=k("arrow-down"),z=k("el-icon"),ne=k("el-button"),I=k("el-dropdown-item"),E=k("el-dropdown-menu"),U=k("el-dropdown"),B=k("el-link"),ee=k("el-switch"),le=fe("action");return a(),g(u(Me),{id:"datasource-manage",ref_key:"mainContainerRef",ref:l,background:""},{default:o(()=>[d(u(Fe),{padding:"1 1 0",border:""},{default:o(()=>[d(u(xe),{ref_key:"SmartSearchRef",ref:b,options:u(j),onHandleSearch:u(Q)},null,8,["options","onHandleSearch"])]),_:1}),d(u(je),null,{default:o(()=>[d(u(Ge),{ref:"baseTable","operation-width":"220",columns:u(N),"table-data":u(w),"current-page":u(e),"page-size":u(f),total:u(v),"pagination-is-need":!0,"operation-is-need":!0,loading:u(G),"search-form-ref":b.value,"selection-is-need":!1,"index-is-need":!0,onSizeChange:u(O),onCurrentChange:u(A),onSelectionChange:u(i)},{"smart-table_operation":o(()=>[d(U,{onCommand:r},{dropdown:o(()=>[d(E,null,{default:o(()=>[(a(!0),m(q,null,X(u(ae),J=>(a(),g(I,{key:J.code,command:J.code},{default:o(()=>[W(V(J.name),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:o(()=>[d(ne,{type:"primary"},{default:o(()=>[W(" 注册数据源"),d(z,{class:"el-icon--right"},{default:o(()=>[d($)]),_:1})]),_:1})]),_:1})]),name:o(({scope:J})=>[d(B,{type:"primary",onClick:te=>_(J.row)},{default:o(()=>[W(V(J.row.name),1)]),_:2},1032,["onClick"])]),type:o(({scope:J})=>{var te;return[c("span",null,V(((te=u(ae).find(pe=>pe.code===J.row.type))==null?void 0:te.name)||"未知类型"),1)]}),enable:o(({scope:J})=>[d(ee,{modelValue:J.row.enable,"onUpdate:modelValue":te=>J.row.enable=te,class:"swith-btn","active-value":!0,"inactive-value":!1,onChange:te=>n(te,J.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),operation:o(({scope:J})=>[de((a(),g(ne,{type:"primary",link:"",onClick:Ce(te=>D(J.row),["stop"])},{default:o(()=>[W(" 编辑 ")]),_:2},1032,["onClick"])),[[le,"datasource_manager_get"]]),de((a(),g(ne,{link:"",type:"primary",onClick:Ce(te=>K(J.row),["stop"])},{default:o(()=>[W(" 权限配置 ")]),_:2},1032,["onClick"])),[[le,"datasource_manager_get"]]),de((a(),g(ne,{link:"",type:"danger",onClick:Ce(te=>F(J.row),["stop"])},{default:o(()=>[W("删除")]),_:2},1032,["onClick"])),[[le,"datasource_manager_del"]])]),_:1},8,["columns","table-data","current-page","page-size","total","loading","search-form-ref","onSizeChange","onCurrentChange","onSelectionChange"])]),_:1}),d(Bs,{visible:t.dialogVisible,"onUpdate:visible":h[0]||(h[0]=J=>t.dialogVisible=J),"data-source-type":t.dataSourceType,"dom-id":t.domId,"dialog-type":t.dialogType,"cur-edit-id":t.curEditId,onSave:u(R),onChangeEdit:T},null,8,["visible","data-source-type","dom-id","dialog-type","cur-edit-id","onSave"]),d(qs,{visible:t.permissionDialogVisible,"onUpdate:visible":h[1]||(h[1]=J=>t.permissionDialogVisible=J),"edit-id":t.permissionSetId,onSave:u(R)},null,8,["visible","edit-id","onSave"])]),_:1},512)}}});const to=Xe(Fs,[["__scopeId","data-v-e97d75e0"]]);export{to as default};
