import{q as O}from"./lodash.22f463b4.js";import{g as A}from"./index.vue_vue_type_style_index_0_scoped_7b7c1886_lang.2666f209.js";import{r as P,c as h,S as L,aj as f}from"./element-plus.59ccb443.js";import{r as i}from"./login.a4e9287e.js";const R={getTemplatePageList({name:a,dataType:n,dataLayerType:o,creatorId:m,catalogId:l,rows:s,page:c}){return i.doGetPromise("/resourcerelease/manager/template/list",{name:a,dataType:n,dataLayerType:o,creatorId:m,catalogId:l,rows:s,page:c})},saveOrUpdateTemplate(a){return i.doPostPromiseJson("/resourcerelease/manager/template/saveOrUpdate",a,{})},getTemplate(a){return i.doGetPromise("/resourcerelease/manager/template/info",{id:a})},deleteTemplate(a){return i.doPostPromise("/resourcerelease/manager/template/delete",{id:a},{})},checkTemplateName(a,n){return i.doGetPromise("/resourcerelease/manager/template/checkname",{name:a,id:n})},exportTemplate(a){return i.doGetPromise(`/resourcerelease/manager/template/exportTemplate/${a}`,{},{responseType:"blob"})},importTemplate(a){return i.doPostPromiseForm("/resourcerelease/manager/template/importTemplate",a,{})}},k={LAYER:"矢量图层",COVERAGE:"栅格图层",TABLE:"数据表",ENTITYOBJECT:"实体对象",ENTITYRELATIONSHIP:"实体关系"},q={POINT:"点",LINE:"线",POLYGON:"面"},x={DICTIONARY:"数据字典",STRING:"字符串",INT:"整数",DECIMAL:"小数",BOOLEAN:"布尔值",DATE:"日期",DATETIME:"日期时间"},g="Entity_Code",E="Entity_Name",p="source",T="target",D=[g,E,p,T],U=["Integer","STRING","INT64","INT32","INT16","INT8","double","float","DECIMAL","DATE","DATETIME","time","duration","BOOLEAN","bool","List","Set","Map","point","lineString","polygon"];function Y(a){const n=P({checkingUniq:!1,checkTimer:null,cascaderProps:{expandTrigger:"hover"}}),o=h(()=>{const r=Object.entries(k).map(([e,t])=>({value:e,label:t}));return r[0].children=Object.entries(q).map(([e,t])=>({value:e,label:t})),r}),m=h(()=>{var e;const r=O.cloneDeep(o.value);return(e=r[0].children)==null||e.unshift({value:"",label:"所有"}),r.unshift({value:"",label:"所有"}),r});function l(r,e,t){if(e){const d=e.match(/[\W_]/);d&&d.length>0?t(new Error("模板标识不能输入汉字、空格和特殊符号!")):(n.checkingUniq=!0,n.checkTimer&&clearTimeout(n.checkTimer),n.checkTimer=setTimeout(()=>{R.checkTemplateName(e,(a==null?void 0:a())||"").then(u=>{n.checkingUniq=!1,u.code==="0000"?u.data?t():t(new Error("该模板标识已被使用")):(f({type:"warning",message:u.message}),t(new Error("后台验证失败，无法通过")))}).catch(()=>{n.checkingUniq=!1,f({type:"error",message:"验证是否重名接口失败"}),t(new Error("后台验证失败，无法通过"))})},500))}else n.checkTimer&&clearTimeout(n.checkTimer),n.checkingUniq=!1,t(new Error("模板标识不能为空!"))}function s(){return{id:A(),name:"",aliasName:"",type:"",primaryKey:!1,length:32,decimal:0,required:!1,description:"",indexYn:!1,initialValue:"",dictTypeId:""}}function c(){const r=[],e=s();e.name=g,e.aliasName="实体编码",e.type="STRING",e.length=255,e.required=!0,e.indexYn=!0,r.push(e);const t=s();return t.name=E,t.aliasName="实体名称",t.type="STRING",t.length=255,t.required=!0,r.push(t),[...r]}function N(){const r=[],e=s();e.name=p,e.aliasName="来源实体",e.type="STRING",e.length=255,e.required=!0,e.indexYn=!0,r.push(e);const t=s();return t.name=T,t.aliasName="目标实体",t.type="STRING",t.length=255,t.required=!0,t.indexYn=!0,r.push(t),[...r]}function y(r){return!(D.includes(r.name)&&r.aliasName&&r.required)}function I(r){return[p,T].includes(r.name)}return{...L(n),cascaderOptions:o,cascaderOptionsWithAll:m,checkTemplateName:l,createTableItem:s,getDefaultEntityObjectTable:c,getDefaultEntityRelationshipTable:N,isSelectable:y,isRelationKey:I}}export{R as A,p as a,T as b,g as d,U as k,x as t,Y as u};
